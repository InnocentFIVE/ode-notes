\documentclass[twoside]{article}
\usepackage{ctex}
\usepackage{fontspec}
% \usepackage{amsmath}
\usepackage[b5paper,scale=0.8]{geometry}
\usepackage{tcolorbox}
\usepackage{tabu,multirow}
\usepackage{setspace}
\usepackage{caption}
\usepackage{pxrubrica}
\usepackage{tikz,pgfplots,tikz-cd}
\usepackage{ulem}
\usepackage{tabu}
\usepackage{extarrows}
\usepackage{hyperref}
\usepackage{footnote}
\usepackage{nicematrix}
\usepackage{unicode-math}
\usepackage{titlesec}
\usepackage{fancyhdr}
\usepackage{xcolor}

\setmathfont{Garamond-Math.otf}[StylisticSet={2, 7, 9}]
\setmathfont{Garamond-Math.otf}[StylisticSet={2, 7, 9, 8}, version=a]
\setCJKmainfont[BoldFont = GenYoMin-B.ttc]{GenWanMin TW TTF}
\setCJKmainfont[CharRange="2014]{FZXYSJW.TTF}

\newcommand{\Ai}{\mathop{\rm Ai}}
\newcommand{\Bi}{\mathop{\rm Bi}}
\fancypagestyle{forsection}
{
\fancyhf{}
\renewcommand{\headrulewidth}{0pt}
\fancyfoot[RO]{\vskip-8em\rotatebox[origin=rb]{-90}{{\LARGE\char"2619}\enspace{\bfseries\Roman{page}}\enspace{\LARGE\char"2767}}\kern-3em}
\fancyfoot[LE]{\vskip-8em\hspace{-3em}\rotatebox[origin=lb]{90}{{\LARGE\char"2619}\enspace{\bfseries\Roman{page}}\enspace{\LARGE\char"2767}}}
\fancyfoot[C]{}
\fancyhead[C,L,R]{}
}


\newcommand{\res}{\raisebox{-0.3ex}{\mbox{\Large$\symscr{R\kern-0.35ex \scalebox{0.964}{$\symcal e$}{\kern-0.15ex\scalebox{0.8}{$\symscr s$}}}$}}\kern-0.15ex}

\DeclareMathOperator{\besselj}{J}  
\DeclareMathOperator{\bessely}{Y}  
\fancyfoot[RO]{\vskip-8em\rotatebox[origin=r]{-90}{{\LARGE ☙}\enspace{\bfseries\Roman{page}}\enspace{\LARGE ❧}}\kern-2.5em}
\fancyfoot[LE]{\vskip-8em\hspace{-2.5em}\rotatebox[origin=l]{90}{{\LARGE ☙}\enspace{\bfseries\Roman{page}}\enspace{\LARGE ❧}}}
\fancyfoot[C]{}



\newfontface\emojifontsettings{Seguiemj.ttf}[Renderer=HarfBuzz]

\newcommand{\emoji}[1]{{\emojifontsettings#1}}
\defaultfontfeatures{RawFeature={+calt,+swsh,+liga,+hlig,+clig,+dlig,+tnum,+lnum}}

\tcbuselibrary{skins, breakable, theorems, most}
\pagestyle{fancy}

\newtcbtheorem[number within=section]{tho}{定理}{colback=gray!20,colframe=gray!150,fonttitle=\bfseries,arc=0mm,leftrule=0mm,toprule=0mm,bottomrule=1mm,rightrule=0mm}{th}

\setmainfont{EB Garamond}[ItalicFont = EBGaramond12-Italic.otf, Renderer = OpenType]
\newfontface\zapfinolig{Zapfino Extra LT Two}[Renderer = OpenType,RawFeature={+calt,+swsh,+liga,+hlig,+clig,+dlig,+tnum,+lnum}]

\setmathfont[range = "0211C]{Latin Modern Math}

%\everymath{\displaystyle}
\renewcommand{\symcal}[1]{{\mathversion{a}\mbox{$\symscr{#1}$}}}
\newcommand{\dx}{\symscr{D} _t (x)}
\newcommand{\dw}{\symscr{D} _z (w)}
\newcommand{\ddw}{\symscr{D}^2 _z (w)}
\newcommand{\newsout}[1]{\kern0ex\raisebox{0.25ex}{\sout{\raisebox{-0.25ex}{#1}}}\kern0ex}

\def\uppartial{\symup\partial}
\renewcommand{\textbf}[1]{\mbox{\bfseries#1}}
\catcode`\，=13
\def，{, }
\catcode`\。=13
\def。{. }
\catcode`\：=13
\def：{: }
\catcode`\；=13
\def；{; }
\catcode`\！=13
\def！{\,!\,}
\catcode`\？=13
\def？{\,?\kern0.5em}
\catcode`\（=13
\def（{\raisebox{0.28ex}{\,(}}
\catcode`\）=13
\def）{\raisebox{0.28ex}{)\,}}
\catcode`\“=13
\def“{``}
\catcode`\”=13
\def”{''}
\catcode`\、=13
\def、{\mbox{\char"3001\kern-0.35em}}
\catcode`\「=13
\def「{\mbox{\kern-0.35em\char"300C}}
\catcode`\」=13
\def」{\mbox{\char"300D\kern-0.35em}}




\begin{document}


\titleformat{\section}[display]
{}{\newpage\thispagestyle{forsection}
	\filright{\hrule width 1cm\vskip-1.95em}\hspace*{1cm}
	\enspace
	{\LARGE\char"E001}
	\enspace
	\raisebox{0.8ex}{$\underset{\mbox{\tiny\textit{SECTION}}}{\textbf{\textit{\Huge{\arabic{section}}}}}$}
	\enspace{\LARGE\char"E002}
	\enspace
	\titlerule}{1em}{\vspace{-3ex}\Large\bfseries\rightline}

\titleformat{\subsection}[hang]
{}{\normalsize\filright\raisebox{-1.3ex}{\huge\char"B6}\kern-2.3ex{\color{white}\normalsize\arabic{subsection}}\enspace}{0.5em}{\normalsize\bfseries}

\pagestyle{empty}
\setlength{\lineskip}{5pt}
\setlength{\lineskiplimit}{2.5pt}

\setcounter{section}{-1}

\section*{前言}

这篇文章（如果写得完的话）应该是一篇 ODE 的小短文，按照笔者的想法，笔者更倾向于将叙述形式变为两个人之间的对话，这两个人就叫做“朱鹭子”和“琪露诺”吧（笑），至于为什么……那只是因为笔者喜欢罢了（笑）。

由于笔者才疏学浅，其中必定错漏百出，请多指教。

\rightline{\ruby[g]{小飞舞}{Innocent\ FIVE}}
\newpage
\tableofcontents
\newpage
\phantom{2}
\vspace{2em}
\begin{spacing}{2}
	\rightline{\Huge\parbox{1em}{\fontsize{60pt}{80pt}{\bfseries 朱鹭子和琪露诺}}\hspace{2em}}
\end{spacing}
\clearpage
\pagestyle{fancy}
\section{什么是ODE}
朱鹭子：ODE被称为“\ruby[g]{常微分方程}{{Ordinary Differential Equation}}”，是一种奇怪的方程，它代表了一些奇怪的量之间的奇怪关系，我记得你是学过微积分的吧？

琪露诺：呃……学过一点（挠头）。

朱鹭子：那就好，线性代数呢？

琪露诺：\emoji{😥}…… 只看过那本同济的……

朱鹭子：我的天……那本啊……\emoji{😖}算了也没关系，都一样的……行，那我开始说了啊……
\section{一阶ODE的初等解法}
朱鹭子：一阶的ODE在某种意义上是最简单的ODE了，所以我们可以先来研究它。我们知道，ODE事关待求解函数 \(x(t)\) 的导数，这个导数可能是很高阶的，比如：

\[
	\symscr{D} ^n_t (x)=f(t,x)
	.\]

此时我们……

琪露诺：等等等等，这个 \(\symscr{D} \) 是什么……

朱鹭子：哦这个啊，我们管它叫“求导算符”，这里这样写指的是对 \( t\) 求 \(n\)次导，同时，我们也默认 \(x\) 是关于 \(t\) 的函数。我么继续，上面这个式子是一个 \(n\)阶的ODE，我们不想讨论它，我们直接来看最简单的：
\[
	\symscr{D} _t (x)=f(t)g(x)
	.\]
这种被称为“变量分离方程”。
\subsection{变量分离方程}
朱鹭子：这种我们可以这样做：
\[
	\dfrac{\symscr{D} _t(x)}{g(x)}= f(t)
	.\]
两边积分就可以得到：
\[
	\int \dfrac{1}{g(x)} \,\mathrm{d}x =\int f(t) \,\mathrm{d}t \tag{A}
	.\]

琪露诺：诶等等，这个 \(\symscr{D} _t(x)\) 到哪里去了？

朱鹭子：啊这个的话……实际上是有
\[
	\int \dfrac{1}{g(x)} \,\mathrm{d}x =\int \dfrac{\symscr{D} _t(x)}{g(x)} \,\mathrm{d}t
	.\]
这个，这个你不是有学的吗？

琪露诺：呃我忘了……

朱鹭子：啊这……好，现在我们看 A 方程的两边，左边只和 \(x\) 有关，右边只和 \(t\)有关，那么我们实际上就把 \(x(t)\)解出来了，虽然用的是隐式方程的表示法。

琪露诺：原来如此，这有什么要注意的地方吗？

朱鹭子：有，积分记得加上常数。接下来我们来看另外一种方程。
\subsection{线性微分方程}
朱鹭子：好，我们来看看这种：
\[
	\dx{}+p(t)x=f(t)\tag{B}
	.\]
这种被称为线性微分方程。

琪露诺：\emoji{🤔}诶……这个线性指的是什么意思呢……

朱鹭子：我们可以这样理解。假设 \(x_1\)和 \(x_2\)都是方程  B 的解，那么我们考虑：
\[
	x_3=cx_1+(1-c)x_2
	.\]
这个是不是方程B的解呢？

琪露诺：\emoji{😥}好像是的。

朱鹭子：对，没错，这里实际上是有：
\[
	\begin{cases}\\[-2em]
		\symscr{D} _t^n(x_1+x_2)=\symscr{D} _t^n(x_1)+\symscr{D} _t^n(x_2), \\
		\symscr{D} _t^n(cx_1)=c\cdot \symscr{D} _t^n(x_1).
	\end{cases}\tag{C}
\]
这里指的是求导算符的函数线性，另外我们考虑更普遍的形式：
\[\label{linearofl}
	\begin{aligned}
		 & \symscr{L}_1 =\symscr{D} _t^n +a_{n-1}(t)\symscr{D} _t^{n-1}+\cdots a_1(t)\symscr{D} _t +a_0(t)=\symscr{D} _t^{n-1}+\sum_{i=1}^{n-1} a_{i}(t)\symscr{D} _t^i , \\
		 & \symscr{L}_2 =\symscr{D} _t^n +b_{n-1}(t)\symscr{D} _t^{n-1}+\cdots b_1(t)\symscr{D} _t +b_0(t)=\symscr{D} _t^{n-1}+\sum_{i=1}^{n-1} b_{i}(t)\symscr{D} _t^i.
	\end{aligned}
\]
那么算符 \(\symscr{L}_1 \)和 \(\symscr{L} _2\)满足：
\[
	\left(\symscr{L} _1+\symscr{L} _2 \right) (x)=\symscr{L} _1(x)+\symscr{L} _2 (x)
	.\]
这被称为算符线性。

因此合并起来就是：

\[
	\left( \symscr{L} _1+\symscr{L} _2 \right) \left( x_1+x_2 \right) =\symscr{L} _1(x_1)+\symscr{L} _1(x_2)+\symscr{L} _2(x_1)+\symscr{L} _2(x_2)
	.\]

琪露诺：哦哦，原来线性指的是我可以随意拆掉括号啊……

朱鹭子：不可以哦，只是满足C方程罢了，你只能在规定的范围内行动。虽说如此，线性方程确实是比较简单的一类。好，我们来看B方程，这个怎么解呢？

琪露诺：我在寺子屋里见过这些题，一般来说左边都是一些函数的导数，然后两边积分就可以求出函数出来。

朱鹭子：没错，但是在这里，这个 \(p(x)\) 是如此随机，左边很可能不是个新函数的导数，我们应该怎么办呢？

琪露诺：\emoji{😭}呜哇哇……

朱鹭子：事实上，我们可以乘上一个新的函数，改变左边那一坨的结构：
\[
	B \implies h(t)\dx{}+h(t)p(t)x=f(t)h(t)\tag{D}
	.\]

琪露诺：可是这样左边还是很怪啊，看起来根本不像个导数……

朱鹭子：是的，所以我们硬来，考虑新的函数 \(h(t)x\)，那么它的导数就是：
\[
	\symscr{D} _t\left( h(t) x(t)  \right)= h(t) \dx +\symscr{D} _t(h(t))x
	.\]
这样我们观察D式，我们可以强行要求：
\[
	h(t)p(t)=\symscr{D} _t\left( h(t) \right)
	.\]

琪露诺：看起来像那个巫女的作风……

朱鹭子：不是哦，\newsout{灵梦哪有那么聪明}。好了，接下来我们的任务就是解出这个奇怪的 \(h(t)\)，还记得变量分离方程吗？\(h(t)\)的约束就是这个变量分离方程哦。

琪露诺：记得，所以我们只要：
\[
	h(t)p(t)=\symscr{D} _t\left( h(t) \right) \implies \int \dfrac{1}{h(t)} \,\mathrm{d}h =\int p(t) \,\mathrm{d}t
	.\]

这意味着：

\[
	\ln h(t)= \int p(t) \,\mathrm{d}t \implies h(t)=\symrm{e} ^{\int p(t) \,\mathrm{d}t }
	.\]

朱鹭子：不对哦，你积分没加常数。

琪露诺：呜哇……那加了常数之后，就是：
\[
	\ln h(t)= \int p(t) \,\mathrm{d}t +c_1\implies h(t)=\symrm{e} ^{c_1}\cdot \symrm{e} ^{\int p(t) \,\mathrm{d}t }
	.\]

是这样吗？

朱鹭子：其实你可以不加的，因为你有一个积分号没有被消掉……但先不管这个，我们可以看到 \(h\)我们已经求出来了，接下来呢？

琪露诺：那这个  \(c_1\)怎么确定啊？

朱鹭子：不用确定，都是满足条件的不是吗？为了容易算我们就让它是0好了。

琪露诺：哦哦，那这样子C方程就是：
\[
	\symscr{D} _t(h(t)x)=f(t)h(t)
	.\]

这是一个变量分离方程，我可以对它进行积分：
\[
	h(t)x= \int f(t)h(t) \,\mathrm{d}t \implies x= \dfrac{\displaystyle \int f(t)h(t) \,\mathrm{d}t}{h(t)}
	.\]

最后是代入 \(h(t)\)的方程得到：
\[
	x=\dfrac{\displaystyle \int f(t)\symrm{e} ^{\int p(t) \,\mathrm{d}t } \,\mathrm{d}t}{\symrm{e} ^{\int p(t) \,\mathrm{d}t }}
	.\]

哇，这啥啊……

朱鹭子：你做的是正确的，这就是B方程的解啦。

\subsection{常数变易法}

琪露诺：原来如此，所以这一节我完全懂了对吧。

朱鹭子：不是哦，再和你说些东西，我们回过头考虑一种更简单的情况：
\[
	\dx+p(t)x=0
	.\]

琪露诺：我知道我知道，这是分离变量方程！

朱鹭子：对，他的解是 \(x=c_1\exp \left(- \int p(t) \,\mathrm{d}t  \right) \) ，我们反倒可以这样考虑，这个 \(c_1\) 并不是一个常数，而是一个函数 \(c_1(t)\)，此时 \(x=c_1(t)\exp \left(- \int p(t) \,\mathrm{d}t  \right)\)反倒是方程B的解，那么会发生什么事呢？

琪露诺：我猜猜……将这个新东西带进去之后会得到一个新的方程。

朱鹭子：没错，我们试试看：
\[
	\begin{aligned}
		 & \phantom{=}\ \,\,\dx+p(t)x=\underline{\symscr{D} _t\left( c_1(t)\exp \left(- \int p(t) \,\mathrm{d}t  \right) \right)} +p(t) c_1(t)\exp \left(- \int p(t) \,\mathrm{d}t  \right)
		\\
		 & =\underline{\symscr{D} _t(c_1(t))\exp \left(- \int p(t) \,\mathrm{d}t  \right)+c_1(t)\exp \left(- \int p(t) \,\mathrm{d}t  \right)(-p(t))}+p(t) c_1(t)\exp \left(- \int p(t) \,\mathrm{d}t  \right) \\
		 & = \symscr{D} _t(c_1(t))\exp \left(- \int p(t) \,\mathrm{d}t  \right) =f(t).
	\end{aligned}
\]

琪露诺：所以这个 \(c_1(t)\)就满足：
\[
	c_1'(t)=f(t)\exp \left(\int p(t) \,\mathrm{d}t  \right) \implies c_1(t)=\int \left[ f(t)\exp \left(\int p(t) \,\mathrm{d}t  \right)  \right]  \,\mathrm{d}t
	.\]

天……这太多积分号了叭……

朱鹭子：确实，但这玩意不是和你之前求的B方程的解差不多吗？

琪露诺：哦也是，那这个方法有什么用呢？

朱鹭子：用处多了，以后我们在解更普遍的方程会用到这个解法，这被称为\textbf{常数变易法}.

琪露诺：哦……

朱鹭子：接下来我们看些更神奇的。

\subsection{恰当微分方程}
考虑一些更通用的情况：
\[
	\dx=f(x,t)
	.\]

我们可以把它写成微分形式：

\[
	f(x,t)\,\symrm{d} t-\symrm{d} x=0
	.\]

再考虑更一般的情况：

\[
	T(x,t)\,\symrm{d} t+ X(x,t)\,\symrm{d} x=0
	.\]

琪露诺：这是啥……

朱鹭子：看到了吗？这其实是微分方程的一种特殊写法，看到这你想到了什么？

琪露诺：\emoji{🤔}……第二类线积分？

朱鹭子：没错！第二类线积分里面有些很好算的情况，那就是“路径无关”的时候，此时应该由什么判别呢？

琪露诺：\emoji{😥}由Green公式应该有：

\[
	\dfrac{\uppartial T}{\uppartial x}=\dfrac{\uppartial X}{\uppartial t}
	.\]

朱鹭子：在函数性质良好的前提下，可以这么做，那么如果是路径无关的话接下来这么求解方程呢？

琪露诺：呃……

朱鹭子：事实上，路径无关场就是梯度场，这意味着存在一个函数 \(u\) 使得：
\[
	\dfrac{\uppartial u}{\uppartial t}=T,\qquad \dfrac{\uppartial u}{\uppartial x}=X
	.\]
所以方程就变成了：
\[
	\dfrac{\uppartial u}{\uppartial t}\,\symrm{d} t+ \dfrac{\uppartial u}{\uppartial x}\,\symrm{d} x=0
	.\]

左边就是 \(u\)的全微分啦，所以我们就有：

\[
	u=c_1
	.\]

这样就解出了 \(x\)了。

琪露诺：那如果没有路径无关怎么办？

朱鹭子：你可以想一下，我们之前怎么解决不是全微分的问题的。

琪露诺：\emoji{😥}难道你说的是，乘上一个新的函数？

朱鹭子：可以这样做，看看吧：
\[
	\dfrac{\uppartial u}{\uppartial t}=hT,\qquad \dfrac{\uppartial u}{\uppartial x}=hX
	.\]

接下来呢？

琪露诺：呃……不知道了。

朱鹭子：事实上我们可以考虑Young定理：
\[
	\dfrac{\uppartial ^2u}{\uppartial x \uppartial t}=\dfrac{\uppartial ^2u}{\uppartial t \uppartial u}\implies \dfrac{\uppartial (hT)}{\uppartial x}=\dfrac{\uppartial (hX)}{\uppartial t}
	.\]

接下来我们可以用乘法法则分离它们：
\[
	X \dfrac{\uppartial h}{\uppartial t}-T \dfrac{\uppartial h}{\uppartial x}=\left( \dfrac{\uppartial T}{\uppartial x}-\dfrac{\uppartial X}{\uppartial t} \right) h
	.\]

琪露诺：好的，那这个方程怎么解？

朱鹭子：事实上这是一个偏微分方程……单纯解它比解原来的ODE更困难。

琪露诺：啊这……这不就是……寄了吗？

朱鹭子：差不多吧，不过的确有一些比较简单的情况。

\begin{itemize}
	\item 当 \( \dfrac{\dfrac{\uppartial T}{\uppartial x}-\dfrac{\uppartial X}{\uppartial t}}{X} =p(t)\) 与 \(x\) 无关的时候。我们有：
	      \[
		      h(t,x)=\exp \left( \int p(t)\,\mathrm{d}t  \right)
		      .\]
	\item 当 \( \dfrac{\dfrac{\uppartial T}{\uppartial x}-\dfrac{\uppartial X}{\uppartial t}}{T} =q(x)\) 与 \(t\) 无关的时候。我们有：
	      \[
		      h(t,x)=\exp \left(- \int q(x)\,\mathrm{d}x \right)
		      .\]
	\item 当 \( {\dfrac{\uppartial T}{\uppartial x}-\dfrac{\uppartial X}{\uppartial t}}=p(t)X-q(x)T\)的时候。我们有：
	      \[
		      h(t,x)=c_1 \exp \left( \int p(t) \,\mathrm{d}t +\int q(x) \,\mathrm{d}x  \right)
		      .\]
\end{itemize}

琪露诺：前两个还好，第三个也太那啥了，这个只有天才才能看出来吧。

朱鹭子：这个不管，反正算是比较简单的情况了（笑）。当然你也可以直接用看就把这个 \(h\)（我们管它叫积分因子）找出来。

琪露诺：这能看出来的吗？

朱鹭子：看你的直觉了……比如说这个？
\[
	\left( x^2 +y^2 +x \right) \,\symrm{d} x +y \,\symrm{d} y=0
	.\]

琪露诺：哇……看起来好难……哭……

朱鹭子：看，其实我们仔细观察的话倒是可以看出一些对偶量：
\[
	\left( x^2 +y^2  \right) \,\symrm{d} x +y \,\symrm{d} y+ x \,\symrm{d} x=0
	.\]

尝试 \(h=\dfrac{1}{x^2 +y^2 }\)，我们可以得到：
\[
	\symrm{d} x+ \dfrac{x\,\symrm{d} x+y\,\symrm{d} y}{x^2 +y^2 }=0\implies \symrm{d} x+\symrm{d} \left( \dfrac{1}{2}\ln \left( x^2 +y^2  \right)  \right) =0
	.\]

所以最后的结果就是：
\[
	x+ \dfrac{1}{2}\ln \left( x^2 +y^2  \right)=c_1
	.\]

琪露诺：这根本不是人能看出来的……

朱鹭子：诶别说，这种对那只九尾策士的确是显然的题……

琪露诺：啊。所以，一阶微分方程就到这里了？

朱鹭子：不对哦，这只是一些基础的，还有一些奇怪的情况需要提及一下。那就是其解的参数表示。

琪露诺：\emoji{😥}好像确实之前没有讲关于参数方程的任何内容呢……

朱鹭子：我们来看一些隐式方程：
\[
	x=f(t,x')
	.\]

这种反倒是将 \(x\) 分离出来了，此时怎么办呢？

琪露诺：\emoji{😣}这不又是一个一般的式子吗，怎么可能会有什么通法？

朱鹭子：你想想看吧，这种和之前的有什么不同？

琪露诺：\emoji{😮}首先是 \(x'\)不能再随意地被分离出来，然后是左边是 \(x\)……

朱鹭子：差不多，想想左边有没有办法变成 \(x'\)呢？

琪露诺：啊，你是说求导？

朱鹭子：对咯：

\[
	\dx= \dfrac{\uppartial f}{\uppartial t}+ \dfrac{\uppartial f}{\uppartial \left( x' \right) }\symscr{D} _t^2(x)
	.\]

我们不妨设 \(p= \dx\)，那么这个方程就可以变为：

\[
	p=\dfrac{\uppartial f}{\uppartial t}+ \dfrac{\uppartial f}{\uppartial p}\symscr{D} _t(p)
	.\]

琪露诺：可是这个方程不还是很怪吗？也不是有通解的那种……诶等等，这下好像 \(\symscr{D} _t(p)\)就分离出来了：
\[
	\symscr{D} _t(p)= \dfrac{p-{\uppartial f}/{\uppartial t}}{{\uppartial f}/{\uppartial p}}
	.\]

接下来我只要按照前面三种方法做就可以解出 \(p\)，然后积分就可以得到 \(x\)了对吧？

朱鹭子：差不多是这样，但是如果你解出来 \(p\)，但是却是无法分离的，导致你没法直接积分，那该怎么办呢？况且你既然能解出 \(p\)，把它往 \(f\)里面一代，不就把 \(x\)解出来了吗，为什么要积分呢？

琪露诺：啊啊啊哇。

朱鹭子：最令人难受的应该是你解出来得到这个吧：

\[
	\psi (t,p,c_1)=0
	.\]

你看，你甚至连通解的参数都是嵌在函数里面的，此时你不考虑参数方程还能怎么办呢？

琪露诺：通解参数是什么哇？

朱鹭子：啊，就里面这个 \(c_1\)，事实上对于一个 \(n\)阶的微分方程，它的通解将会长得像：
\[
	x=\psi (t,c_1,c_2,\cdots ,c_n)
	.\]

其中 \(c_1,c_2,\cdots ,c_n\) 相互独立，这到时候说一下唯一性定理你可能会更明白一些。

琪露诺：好吧，所以最后的参数方程就是：
\[
	\begin{cases}\\[-2em]
		\psi (t,p,c_1)=0, \\
		x=f(t,p).
	\end{cases}
\]

这样咯？那参数就是那个 \(t\)咯。

朱鹭子：\(t\)是自变量，\(p\)才是参数。你要知道 \(p\)才是我们想要消去的那个，所以 \(p\)是参数。

琪露诺：哦。所以这其实是一种“差不多解出来了但还有一步要走”的情况吧？

朱鹭子：的确，看看这种？
\[
	t=f(x,x')
	.\]

这下反倒是自变量被分离出来了。

琪露诺：麻……这是强行走成反函数的路线吗……

朱鹭子：要清楚你现在考虑的是微分结构，不要乱反函数。

琪露诺：呜……首先我左右两边对 \(t\)求导：
\[
	1=\dfrac{\uppartial f}{\uppartial x}\symscr{D} _t(x)+ \dfrac{\uppartial f}{\uppartial (x')}\symscr{D} _t^2(x)
	.\]

然后再设 \(p=\symscr{D} _t(x)\) ，这样子就行啦：
\[
	1=\dfrac{\uppartial f}{\uppartial x}p+ \dfrac{\uppartial f}{\uppartial p}\symscr{D} _t(p)
	.\]

朱鹭子：不错，这也有另外一种方法，那就是上来直接对 \(x\)求导：
\[
	\symscr{D} _x(t)=\dfrac{\uppartial f}{\uppartial x}+\dfrac{\uppartial f}{\uppartial p}\symscr{D} _x(p)
	.\]

然后由于一阶微分形式的不变性，我们可以把它改写为：
\[
	\dfrac{1}{p}=\dfrac{\uppartial f}{\uppartial x}+\dfrac{1}{p}\cdot \dfrac{\uppartial f}{\uppartial p}\symscr{D} _t(p)
	.\]

也和你写的一样哦。

琪露诺：哇塞。

朱鹭子：嗯，来点更怪的例子，如果你最后解出来是这样子的：

\[
	\begin{cases}\\[-2em]

		x'=X(c) , \\
		\ t=T(c).
	\end{cases}
\]

这种情况呢？你该怎么得到——没有其他条件了—— 那个\(x\)呢？

琪露诺：寄。我试试看，首先是：
\[
	\symscr{D} _c(x)=\symscr{D} _t(x)\symscr{D} _c(t)= X(c)T'(c)\implies \begin{cases}\\[-2em]
		x=\int   X(c)T'(c)\,\mathrm{d}c, \\
		\ t=T(c).
	\end{cases}
\]

依据微分形式不变性好像是这样的？

朱鹭子：的确。总而言之，你就得构造这个 \(\symscr{D} _c(x)\)然后对其积分，虽然得到的结果是参数方程，不过也值了不是吗？

琪露诺：听起来是这样没错啦……
\section{存在唯一性定理}

\subsection{什么是存在唯一性定理}
朱鹭子：在此之前，我们得到的ODE全都无视了它是否有没有解，\textbf{解是否唯一}，这里倒是准备和你说一下这些。

琪露诺：存在性吗……感觉很枯燥……

\begin{tho}[label=czwy]{存在唯一性定理}{}
	对于一个将导数分离出来的ODE：
	\[
		\dx=f(t,x)
		.\]
	如果 \(f\)在开区域 \(\overline{\symcal{I} }\) 上面满足：任意 \(\overline{\symcal{I} }\)中的闭矩形区域 \(\overline{\symcal{G}} \)上都满足Lipschitz条件：
	\[
		\left\vert f(t,x_1)-f(t,x_2) \right\vert \leqslant L \left\vert x_1-x_2 \right\vert ,\,\forall (t,x_1),(t,x_2)\in \overline{\symcal{G}}
		.\]

	且有初始条件：\(x(t_0)=x_0\)，则存在解 \(x=X(t) \)在点 \((t_0,x_0)\)的邻域内有定义，且该解可以延拓到任意接近 \(\overline{\symcal{I} }\)的边界。
\end{tho}

琪露诺：???????这都啥啊……

朱鹭子：这确实很怪……让我尝试说明一下。为了方便，我们先从单变量的实函数开始说明：
\[
	y=f(x) \,\mbox{或者}\, f: \overline{\symcal{I} } \subseteq\symbb{R}     \mapsto  \symbb{R}
	.\]
如果存在常数 \(L\)使得：
\[
	\left\vert f(a)-f(b) \right\vert \leqslant L \left\vert a-b \right\vert, \,\forall a,b\in  \overline{\symcal{I} }
	.\]

则我们称 \(f\)满足Lipschitz 条件，而 \(L_{\mathrm{m}in}\)被称为Lipschitz常数，如果这个常数小于一，我们会称 \(f\)是\textbf{压缩映射}。这个我们先不管了，你只要先知道，如果 \(f\) 是在区域内满足Lipschitz条件，那么给出 \(x\)的一个初值条件时候，\(x\)唯一可解。

另外一件事是，要确立一个函数的Lipschitz条件是非常麻烦的一件事，我们可以用：\(\dfrac{\uppartial f}{\uppartial x}
\)连续来替代。

琪露诺：看起来要好不少……至少有比较良好的方式了。

朱鹭子：对，现在你可以考虑以下这种，如果你没法把 \(x'\)分离出来怎么办？
\[
	F(x,x',t)=0
	.\]
这种呢？

琪露诺：啊……我感觉……可以试试隐函数存在定理，只要在邻域内 \(\dfrac{\uppartial F}{\uppartial x'}\Bigg|_{(t_0,x_0)}\neq 0\)的话，那我就可以在这里把 \(x'\) 解出来。

朱鹭子：没错，这意味着有一些\(\dfrac{\uppartial F}{\uppartial x'}\Bigg|_{(t_0,x_0)}=0\)的情况。
\subsection{包络线}

琪露诺：什么情况呢？

朱鹭子：我和你说个问题，如果有这样一种解，它的并不属于通解，但它也是微分方程的解，而且满足一种特殊的性质：
\begin{itemize}
	\item 这条曲线的每一点处都有一条通解曲线与其相切。
\end{itemize}
这种曲线被称为上述通解积分曲线族的\textbf{包络}。

琪露诺：包络？那是什么？

朱鹭子：在这里我可以给出一些例子：

\begin{center}
	\includegraphics{envelope.pdf}
\end{center}

假如有这样一些直线，它的 \(y\)轴截距和 \(x\)轴截距加起来是 1，并且那两个截距都大于零，图中画出了一些这样的直线（灰色部分），那么黑色曲线就是它的包络线。

琪露诺：哇，好像它就是把灰色线的运动紧紧包裹住了一样。

朱鹭子：差不多，不过实际上应该是相切吧（笑），比如离原点距离为1的直线的包络就是单位圆嘛。

琪露诺：那包络线怎么求呢？

朱鹭子：实际上我们知道那些通解，或者更广泛地，曲线族的形式可以表示为：
\[
	F(t,x,c_1)=0
	.\]

那么包络线的方程是会满足：
\[
	\begin{cases}\\[-2em]
		F(t,x,c_1) =0, \\
		\dfrac{\uppartial F}{\uppartial c_1}=0.
	\end{cases}\tag{E}
\]

针对 \(c_1\)的参数方程。但是满足这方程的曲线可能有很多，其中并不一定有包络线。但毫无疑问的是，包络线的确是一种特殊的存在。现在我们来看看包络线和微分方程的关系：

想想看，对于一个一阶微分方程，它对解曲线的性质描述只精确到一阶导数，那么看看我们的包络线——每一点都有一条曲线族中的曲线\textbf{与之相切}，如果这族曲线是一个一阶ODE的解的话……

琪露诺：那是不是意味着，这个包络上面所有点都满足那个方程……因为导数一样了， 点也在那些解的曲线上面。

朱鹭子：没错！这其实就是说这个包络线也是ODE的解，这其实是ODE的\textbf{奇解}。当然这也就意味着不满足那个唯一性条件了，所以根据你之前说的……

琪露诺：隐函数存在定理。

朱鹭子：对，所以对于初始条件 \(x(t_0)=x_0\)，应当有：
\[
	\dfrac{\uppartial F(t,x,x')}{\uppartial x'}\Bigg|_{(t_0,x_0)}
	.\]

但这只是最基本的条件，事实上，由E式子我们知道，我们把 \(\dx\) 看成是 \(c_1\)……然后实际上这个\ruby[g]{包络}{奇解}应该满足：
\[
	\begin{cases}\\[-2em]
		F(t,x,x')=0 , \\
		\dfrac{\uppartial F}{\uppartial x'}=0.
	\end{cases}
\]

将这玩意把 \(x'\)消去就是包络线要满足的方程了，同理，这只是其中一个条件而已。

琪露诺：又来……全都是仅仅能满足的程度吗？有没有充要条件呢？

朱鹭子：饶了我吧，我暂时还不知道（笑），上面这个主要是来判断一个ODE有没有奇解的，这样的解往往会……就像幻想乡对于外界一样吧（笑）。

琪露诺：又是听不懂的比喻……

朱鹭子：这倒是有个出名的例子，叫做Clairaut微分方程：
\[
	x=t\dx+f\left( \dx\tag{ſ} \right)
	.\]

琪露诺：这是什么奇怪的记号……积分号吗？

朱鹭子：这个不管，你试试鼓捣鼓捣这个ODE。

琪露诺：哦……首先两边对 \(t\)求导，得到：
\[
	\dx=x\symscr{D} ^2_t(x)+\dx+f'\left( \dx \right)\symscr{D} ^2_t(x)
	.\]

约去两边的 \(\dx\)得到：
\[
	\symscr{D} ^2_t(x)\left( x+f'\left( \dx \right)  \right) =0
	.\]

所以事实上是 \(\symscr{D} ^2_t(x)=0\implies \dx=c_1\)和 \(x+f'\left( \dx \right)=0 \)。

接下来我只需要积分就可以……哦直接代方程……就可以：
\[
	x=c_1x+f(c_1)
	.\]

哇是一坨子直线。所以你的意思是说另外一个 \(x+f'\left( \dx \right)=0\)其实是这些直线的包络吗？

朱鹭子：事实上的确是这样，在这里就先不验证了，但不管怎么样，记住有奇解存在这件事还是相当重要的。


\section{高阶线性微分方程}

\subsection{高阶线性微分方程的解的结构}
朱鹭子：这里我们算是基本把一阶ODE的方法讨论得差不多了，接下来是有关高阶线性微分方程的一些理论。

琪露诺：听上去非常恐怖的样子……

朱鹭子：事实上的确比一般的一阶微分方程要麻烦不少：
\[
	\symscr{L} (x)= f(t)
	.\]

其中，我们认为 \(\symscr{L} \)是一个线性算子，就像之前提到的一样。接下来我们来考虑下最基本的齐次方程：
\[
	\symscr{L} (x)=0\tag{HOMs}\label{HOMs}
	.\]

我们来研究它解的结构。首先，如果（假如有的话） \(x_1(t),\cdots x_k(t)\) 都是它的解，那么这个呢：
\[
	x_{\rm new}= \sum_{i=1}^{k} c_i x_i
	.\]

实际上就是 \(x_1(t),\cdots x_k(t)\) 的线性组合，这个是不是ODE的解呢？

琪露诺：按感觉来说应该是……

朱鹭子：实际上我们可以这样子：

\[
	\symscr{L} \left( \sum_{i=1}^{k} c_i x_i \right) =\sum_{i=1}^{k}\symscr{L}\left(  c_i x_i\right) =\sum_{i=1}^{k} c_i\underset{0}{\underbrace{\symscr{L}\left(  x_i\right)}}=0\label{djyl}
	.\]

上面的等号分别用到了 \(\symscr{L} \)算子的\hyperref[linearofl]{\underline{函数线性}}的两个方面。这实际上被称为\textbf{叠加原理}。

琪露诺：\emoji{😅}

朱鹭子：？

琪露诺：啊没……\emoji{🥶}

朱鹭子：用正常的话来说，就是\(x_1(t),\cdots x_k(t)\)的\textbf{张成}也属于原方程\hyperref[HOMs]{\underline{（HOMs）}}的解空间。而接下来我们需要一个可以衡量这些函数是否线性相关的工具。

琪露诺：为什么要研究他们是不是线性相关的啊……

朱鹭子：因为如果有线性相关的话，证明这些函数之间并不是真正独立的，有些函数可以用其他函数表示。这就意味着你所得到的并不是 \(k\)个解。

琪露诺：原来如此，所以是要用行列式还是什么吗？

朱鹭子：确实可以用行列式，首先看下针对函数的的线性相关/无关：
\begin{itemize}
	\item 如果存在不全为 0 的常数 \(c_1,\cdots ,c_k\)，以及函数 \(x_1(t),\cdots x_k(t)\) 使得：
	      \[
		      \sum_{i=1}^{k} c_i x_i(t)\equiv 0
		      .\]
	      在 \(t \in\symcal I\)上面恒成立，这意味着这些函数在区间 \(\symcal{I} \) 上线性相关，否则就是线性无关。
\end{itemize}

实际上就是把线性相关的容差扩展到区间上来（大致来说）。

琪露诺：看起来很之前的线性相关一样。

朱鹭子：但实际上是不一样的。同样，我们可以用行列式的值是否为0来判断（实际上不能）一坨东西是不是真的线性相关，比如Wronsky行列式：
\[
	\symscr{W}_t \left( x_1,\cdots x_k \right) \coloneq \begin{vmatrix}
		x_1(t)         & x_2(t)         & \cdots & x_k(t)         \\
		x_1'(t)        & x_2'(t)        & \cdots & x_k'(t)        \\
		\vdots         & \vdots         &        & \vdots         \\
		x_1^{(k-1)}(t) & x_2^{(k-1)}(t) & \cdots & x_k^{(k-1)}(t) \\
	\end{vmatrix}
	.\]

琪露诺：诶？为什么和求导有关系？

朱鹭子：因为如果线性相关那坨方程： \(\sum_{i=1}^{k} c_i x_i(t)\equiv 0\) ，那么左右两边求导亦为0，这就意味着不管是 \(c_i(t)\) 的多少阶导都是线性相关的（当然建立在可以导那么多次的情况下），实际上是给这些函数一些条件，让他们刚好可以凑成一对行列式。
不管如何，这个行列式可以在某种程度上反应函数是否是线性相关的。
事实上有以下这些定理：
\begin{itemize}
	\item 如果函数们线性相关，那么她们的Wronsky行列式为0。

	      这个其实可以轻易得到存在一组非0的常数 \(C_1,\cdots C_n\) 使得：
	      \[
		      \sum_{i=1}^{k} C_i(t)x_i(t)=0\xlongequal[]{\mbox{\tiny 连续求导 \(k\) 次}} \begin{bmatrix}
			      \sum_{i=1}^{k} C_i x_i(t) \\    \sum_{i=1k}^{k} C_i x_i'(t) \\    \vdots \\    \sum_{i=1}^{k} C_i x^{(k-1)}(t) \\\end{bmatrix}
		      \equiv \symbf 0 \implies\symbfscr{W} \cdot\symbfit C \equiv\symbf 0
		      .\]

	      其中我们不妨设 \(\symbfscr{W}\) 是Wronsky矩阵（即Wronsky行列式去掉行列式符号的形式），而 \(\symbfit C \) 是一个系数矩阵 \(\begin{bmatrix}
		      C_1 &    C_2 &  \cdots  &    C_k \end{bmatrix}^{\rm T}\)，我们知道 \(\symbfit C\) 是有非零解的，这意味着 \(\symscr{W} \equiv 0\).
	      另外要指出的事情是，其逆定理一般是不成立的，举个例子吧：\(1,t,\cdots t^{k-1},\symrm{e} ^{-1 / t^2 }\)，这一些函数，注意到当 \(t=0\)时，\(\symrm{e} ^{-1 / x^2 }\)的每一阶导都为零，所以此时Wronsky行列式必然有一列全是0，此时行列式为0，但实际上这个函数序列是线性无关的。
	\item 另外一个同样重要的是，如果 \(x_1,\cdots, x_k\) 都是方程 \(\symscr{L} (x)=0\) 的解，那么上面这个“逆定理”反而是成立的。实际上我们可以用的除了刚才那些，还有由于这些函数是ODE的解而使用的存在唯一性定理。
\end{itemize}

琪露诺：为什么这里满足存在唯一性定理的条件呢？

朱鹭子：这里会涉及到高阶微分方程的解的存在唯一性，事实上我们可以把它变成 \(n\) 个一阶线性方程，实际上就是一个线性方程组，具体的存在唯一性这里不再阐述。暂且解决完这个之后，我们继续：
\begin{itemize}
	\item ……另外一个同样重要的是，如果 \(x_1,\cdots, x_k\) 都是方程 \(\symscr{L} (x)=0\) 的解，那么上面这个“逆定理”反而是成立的。实际上我们可以用的除了刚才那些，还有由于这些函数是ODE的解而使用的存在唯一性定理。
	      事实上，这个所谓逆定理指的是：如果 \(x_1,\cdots, x_k\) 都是方程 \(\symscr{L} (x)=0\) 的解且在 \(t \in\symcal{I} \) 上面线性无关，则 \(\symscr{W}_t \left( x_1,\cdots x_k \right)\neq 0,\,\forall t\in\symcal{I} \)。我们可以采用反证法，如果真的有这么一个 \(t_0\) 存在，使得 \(\symscr{W}_t \left( x_1,\cdots x_k \right)\big|_{t_0} \coloneq \symscr{W}( t_0 ) =0 \)，那么事实上考虑这样的方程组：
	      \[
		      \symbfscr{W}\left( t_0 \right) \cdot \symbfit C \equiv 0
		      .\]
	      注意这只是针对 \(t_0\) 一个点的方程，由于 \(\symscr{W}( t_0 ) =0\)，上面这个方程必然有非零解 \(C_1,\cdots ,C_k\)，则考虑下面这个函数：
	      \[
		      x_{\rm add}(t)=\sum_{i=1}^{k} C_i x_i(t),\, t\in\symcal{I} \label{gouzaoofxadd}
		      .\]

	      由于\hyperref[dlyl]{\underline{叠加原理}}，\(x_{\rm add}(t)=\)是方程\hyperref[HOMs]{\underline{（HOMs）}}的解。那它满足的初始条件是什么呢？
\end{itemize}

琪露诺：诶？为什么要考察初始条件，这不就一个普通的叠加吗？

朱鹭子：你得想清楚我们这些 \(C_1,\cdots ,C_k\)是怎么来的。

琪露诺：\(\symbfscr{W}\left( t_0 \right) \cdot \symbfit C \equiv= 0\) 的解？那就意味着……
\[
	\begin{bmatrix}
		\sum_{i=1}^{k} C_i x_i(t_0) \\    \sum_{i=1k}^{k} C_i x_i'(t_0) \\    \vdots \\    \sum_{i=1}^{k} C_i x^{(k-1)}(t_0) \\\end{bmatrix}
	\equiv \symbf 0 \implies \sum_{i=1}^{k} C_i x_i^{(m)}(t_0)\equiv 0,\,m=0,1,\cdots k-1
	.\]

这个是什么初始条件……

朱鹭子：你想想这个初始条件是足够确定唯一解的吗？

琪露诺：诶？你这话是什么意思哇，这不全都是写确定的函数 \(x_1,\cdots, x_k\) 吗？

朱鹭子：我们要讨论的可不是这个。事实上，这些初值条件实际上等价于：
\[
	\symscr{D} ^i_t(x_{\rm add}(t))\equiv 0,\,i=0,1,\cdots k-1
	.\]

刚好 \(k\) 个，事实上对于一个 \(k\) 阶方程，这 \(k\) 个初始条件足以确定一个唯一解，那么实际上我们可以认为 \(x_{\rm add}(t)\) 是一个 \(k\) 解ODE的\textbf{唯一}解。你意识到什么问题没有？

琪露诺：啊？没什么问题哇，类比一阶微分方程的结论，这确实是一个有 \(k\) 个初始条件决定的唯一解。

朱鹭子：不是，你看看初始条件都是些什么吧。

琪露诺：全是0？

朱鹭子：对，这实际上意味着这是一个零向量……

琪露诺：哦哦哦所以实际上 \(x\equiv 0\) 也是一个解，然后因为解唯一，所以 \(x_{\rm add}\equiv 0\)。

朱鹭子：没错，然后捏？

琪露诺：\emoji{😨}

朱鹭子：注意到我们是怎么样\hyperref[gouzaoofxadd]{\underline{（构造）}} \(x_{\rm add}\) 的：
\[
	x_{\rm add}(t)=\sum_{i=1}^{k} C_i x_i(t),\, t\in\symcal{I}
	.\]

这意味着
\[
	\sum_{i=1}^{k} C_i x_i(t)\equiv 0
	.\]

琪露诺：哦哦然而事实上根本不可能有这件是存在吧，由于 \(C_1,\cdots ,C_k\)不全为零，这意味着 \(x_1,\cdots x_k\)线性相关了！

朱鹭子：确实，但一开始我们就认为 \(x_1,\cdots x_k\) 是线性无关的，因此导出了矛盾，所以
\[
	\symscr{W}_t \left( x_1,\cdots x_k \right) \neq 0,\,\forall t\in\symcal{I}
	.\]

这个是成立的。在刚才的讨论中，我们意识到对于这样的Wronsky矩阵，在某一点处为0就可以推出定义域上的函数值都是0。

琪露诺：这是为什么哇？

朱鹭子：这个嘛……你可以去问问那个九尾妖狐，在这里（喝水）没什么时间说这个。好，我们知道了大致有关Wronsky行列式的两个结论，在这里总结一下：
\begin{itemize}
	\item 如果 \(x_1,\cdots x_k\) 在 \(\symcal{I} \)线性相关，则在 \(\symcal{I} \) 上Wronsky行列式恒为零。
	\item 如果\(x_1,\cdots x_k\) 是方程 \(\symscr{L} (x)=0\) 的解，且在 \(\symcal{I} \)线性无关，则在 \(\symcal{I} \) 上Wronsky行列式恒不为零。
\end{itemize}

事实上第一个可以等价于：
\[
	\boxed{\mbox{如果只要有一点 \(t_0\) 对应的 Wronsky 行列式不为零，则\(x_1,\cdots x_k\)线性无关。}}
\]

琪露诺：这不就是逆否命题吗？

朱鹭子：有用的，我们继续，接下来对于一个 \(n\) 解的线性方程，我们总是可以找到它的 \(n\) 个解，线性相关也能接受，然后给出 \(n\) 个初始条件，这些初始条件我们可以任意选取。

琪露诺：为什么哇？

朱鹭子：因为首先，存在唯一性定理保证这个初始条件对应的解必然存在且唯一，此时我们要验证的其实是上面 \(n\) 个解线性无关的情况存在，为了保证这样，我们需要看一下盒子里的内容，保证Wronsky 行列式至少有一点不为零，实际上这一点就对应了初始条件。看，如果Wronsky 行列式长这样：
\[
	\symscr{W} (t_0)=\begin{vmatrix}
		1      & 0      & \cdots & 0      \\
		0      & 1      & \cdots & 0      \\
		\vdots & \vdots &        & \vdots \\
		0      & 0      & \cdots & 1      \\
	\end{vmatrix}=1
	.\]

实际上对应了初始条件。

琪露诺：为什么要是这样一个对角阵呢？

朱鹭子：只是让他不为0罢了，实际上这个行列式对应了初始条件：
\[
	\begin{bmatrix}
		x_1(t_0) & x_1'(t_0) & \cdots & x_1^{(n-1)}(t_0) \\
		x_2(t_0) & x_2'(t_0) & \cdots & x^{(n-1)}_2(t_0) \\
		\vdots   & \vdots    &        & \vdots           \\
		x_n(t_0) & x_n'(t_0) & \cdots & x_n^{(n-1)}(t_0) \\
	\end{bmatrix}=\begin{bmatrix}
		1      & 0      & \cdots & 0      \\
		0      & 1      & \cdots & 0      \\
		\vdots & \vdots &        & \vdots \\
		0      & 0      & \cdots & 1      \\
	\end{bmatrix}
	.\]

这个实际上对应了 \(n\) 组初始条件，每组条件对应一个解 \(x_i(t)\)，由于存在唯一性定理，这些解 \(x_1,\cdots ,x_n\)必然存在，而且她们对应的 Wronsky 行列式在 \(t=t_0\) 处不为0，这就意味着这实际上是 \(n\) 阶方程的 \(n\) 个线性无关解。

琪露诺：但是实际上 \(n\) 阶方程最多也有 \(n\) 个解吧？

朱鹭子：线性方程， \(n\) 阶线性方程的通解最多只有 \(n\) 个独立参数，这所谓的通解可以表示为：
\[
	x_{\rm G}=\sum_{i=1}^{n} c_i x_i
	.\]

其中 \(x_i\) 是方程的一组线性无关解。这意味着一个 \(n\) 阶齐次线性ODE\textbf{必然}有 \(n\) 个线性无关的解。这被称为该ODE的基本解组。

琪露诺：但这只是齐次的呀，如果不是齐次的话怎么找积分因子呢？

朱鹭子：你总不会认为 \(n\) 阶线性还得靠找积分因子来求非齐次方程的解吧？

琪露诺：那不是……那难道是什么？猜吗？

朱鹭子：猜……倒是的确有这种，不过这里暂且先不论。这里主要讨论的是常数变易法。


\subsection{高阶线性微分方程与常数变易法}
琪露诺：\emoji{😥}，细说。

朱鹭子：呃……其实就是把 \(c_1,\cdots ,c_n\) 这些常数全部变成函数。

琪露诺：诶？这么做有根据吗？

朱鹭子：对线性方程来说，可以用唯一性定理。实际上，常数变易其实是利用了齐次和非齐次之间的关系，比如：
\[
	c_1(t)x_1(t)
	.\]

我求导完之后就是：
\[
	c_1'(t)x_1(t)+c_1(t)x_1'(t)
	.\]

实际上上面两个可以分别对应方程的齐次部分和非齐次部分。

琪露诺：呜呜……还是很抽象……

朱鹭子：那让我们看一个具体的例子：

\begin{tho}{高阶非齐次线性微分方程的常数变易解法}{}
	在\textbf{已经知道基本解组} \(x_1(t),\cdots x_n(t)\)的情况下， \(n\)阶微分方程  \(\symscr{L} (x)=f(t)\)的所有解可以表示成如下形式：
	% \[
	% 	x_{\rm All}= \sum_{i=1}^{n} x_i(t) \, \cdot \int 	\dfrac{\scriptstyle	\begin{vNiceMatrix}[first-row,columns-width = 0.1cm,cell-space-limits = 1pt]\renewcommand{\arraycolsep}{0pt}
	% 			                                 &                             &                     & \raisebox{-1ex}{$\!\!\!\!\!\scriptscriptstyle k-{\rm column}\!\!\!\!\!\!\!$} &                     &                             \\
	% 			\scriptstyle \scriptstyle x_1(t) & \scriptstyle x_2(t)         & \scriptstyle \cdots & \scriptstyle 0                                & \scriptstyle \cdots & \scriptstyle x_n(t)         \\[-3pt]
	% 			\scriptstyle x_1'(t)             & \scriptstyle x_2'(t)        & \scriptstyle \cdots & \scriptstyle 0                                & \scriptstyle \cdots & \scriptstyle x_n'(t)        \\[-3pt]
	% 			\scriptstyle \vdots              & \scriptstyle \vdots         & \scriptstyle \cdots & \scriptstyle \vdots                           & \scriptstyle \cdots & \scriptstyle \vdots         \\[-3pt]
	% 		\scriptstyle x_1^{(n-1)}(t)     &\!\! \!\scriptstyle x_n^{(n-1)}(t) \!\!\!& \scriptstyle \cdots & \scriptstyle 1                                & \scriptstyle \cdots &\!\! \!\scriptstyle x_n^{(n-1)}(t) \!\!\\
	% 		\end{vNiceMatrix}}{\symscr{W} (t)}f(t) \,\mathrm{d}t
	% 	.\]
	\[
		x_{\rm Sol}= \sum_{i=1}^{n} x_i(t) \, \cdot \int\left(  \raisebox{-2.5em}{\(\dfrac{{
						\begin{vmatrix}
							\scriptstyle x_1(t)         & \scriptstyle x_2(t)                       & \scriptstyle \cdots & \scriptstyle 0      & \scriptstyle \cdots & \scriptstyle x_n(t)                     \\[-3pt]
							\scriptstyle x_1'(t)        & \scriptstyle x_2'(t)                      & \scriptstyle \cdots & \scriptstyle 0      & \scriptstyle \cdots & \scriptstyle x_n'(t)                    \\[-3pt]
							\scriptstyle \vdots         & \scriptstyle \vdots                       & \scriptstyle \cdots & \scriptstyle \vdots & \scriptstyle \cdots & \scriptstyle \vdots                     \\[-3pt]
							\scriptstyle x_1^{(n-1)}(t) & \!\! \!\scriptstyle x_n^{(n-1)}(t) \!\!\! & \scriptstyle \cdots & \scriptstyle 1      & \scriptstyle \cdots & \!\! \!\scriptstyle x_n^{(n-1)}(t) \!\! \\[3pt]
						\end{vmatrix}\kern-4em\raisebox{1.8em}{$\kern-8em\overset{i}{\overbrace{\phantom{zzxvxvxvxx3wixcb}}}$\kern 4.6em}}}{\symscr{W} (t)}\)}f(t) \right) \,\mathrm{d}t
		.\]
\end{tho}

琪露诺：\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}
\emoji{😅}


% \[\mbox{\Huge\emoji{😅}}
% \begin{matrix}
% 	\mbox{\emoji{😅}} & \mbox{\emoji{😅}} & \mbox{\emoji{😅}} \\
% 	\mbox{\emoji{😅}} & \mbox{\emoji{😅}} & \mbox{\emoji{😅}} \\
% 	\mbox{\emoji{😅}} & \mbox{\emoji{😅}} & \mbox{\emoji{😅}} \\
% \end{matrix}\mbox{\Huge\emoji{😅}}
% \]
这又是那么多行列式的……这哪里能算？\emoji{😅}

朱鹭子：本身就是不是专门来要你算的啊，而且你没有注意到这个可以机械地给出所有解吗？这比什么取巧的猜测证明要通用的多了。

琪露诺：是倒是……不过当初人们是怎想到用行列式去解决这些破问题的呢？

朱鹭子：其实根本上还是常数变易法，之前我就和你说要记住这个了。

琪露诺：诶？

朱鹭子：这样吧，我给你大概说下，本身我们是知道对于一个线性微分方程 \(\symscr{L} (x)=0\) ，在已知其基本解组 \(x_i\)的情况下，我们可以认为它的所有解如下：
\[
	x_{\rm All,\ HOM} = \sum_{i=1}^{n} c_i x_i(t)
	.\]

指的其实就是其线性组合，现在我们应用常数变易法，\textbf{假设}这样一个非齐次的线性方程的解是：
\[
	x_{\rm Sol} \coloneq \sum_{i=1}^{n} c_i(t) x_i(t)
	.\]

好，但是这样有个问题——琪露诺！你来回答，出了什么问题？

琪露诺：我怎么可能知道……你仅仅是变易了一下就出问题了？

朱鹭子：事实上，常数变易本身是没有问题的，但是真正出问题的时候，我们现在只有：
\[
	\symscr{L} (x_{\rm Sol}) = \symscr{L} \left( \sum_{i=1}^{n} c_i(t)x_i(t) \right) =0
	.\]

这一条方程，但是我们要求的是……

琪露诺：所有的\(c_i(t)\)？

朱鹭子：对，所以方程数量是不够的，那怎么办？

琪露诺：这不挺好的吗，这样找解就方便多了。

朱鹭子：的确，但是怎么找呢？我们知道这样的 \(c_i(t)\) 必有无穷组，他们之间又有什么关系呢？

琪露诺：不清楚……

朱鹭子：事实上这是一个线性方程，如果我们等价到线性代数里面去的话，那么事实上我们可以给出另外 \(n-1\) 个方程来给出，凑够 \(n\) 个方程之后反倒会给出个比较容易看得出来的解。那么给出的这些方程需要满足什么条件捏？

琪露诺：线性？

朱鹭子：没错，针对哪些线性？

琪露诺：那应该是针对 \(c_i(t)\) 和 \(x_i(t)\) 线性就可以了吧……

朱鹭子：我给一个，你看看：
\[
	\sum_{i=1}^{n}\symscr{D} _t(x_i)\cdot \symscr{D} _t(c_i)=0
	.\]

是线性的吗？

琪露诺：是，因为求导运算和乘法本身就是线性的，所以这个方程分别对 \(c_i(t)\) 和 \(x_i(t)\) 线性。

朱鹭子：没错。

琪露诺：那为什么要给这个呢？

朱鹭子：是为了方便计算，且听我说。我们看看刚才的 \(x_{\rm Sol}=\sum_{i=1}^{n} c_i(t)x_i(t)\)，左右两边求导得到：
\[
	\symscr{D} _t\left( x_{\rm Sol} \right) = \sum_{i=1}^{n}\left(  \symscr{D} _t(c_i)x_i+\symscr{D} _t(x_i)c_i\right)  =\underset{0}{\underbrace{ \sum_{i=1}^{n}\symscr{D} _t(c_i)x_i}}+\sum_{i=1}^{n}\symscr{D} _t(x_i)c_i=\sum_{i=1}^{n}\symscr{D} _t(x_i)c_i
	.\]

看！这样我们实际上就简化了 \(\symscr{D} _t\left( x_{\rm Sol} \right) \)，只通过一次条件，另外，我问一下为什么我要消去这个 \(\sum_{i=1}^{n}\symscr{D} _t(c_i)x_i\) 而不是 \(\sum_{i=1}^{n}\symscr{D} _t(x_i)c_i\)？

琪露诺：\emoji{🤔}……也许是因为 \(x_i\) 是 \(\symscr{L} (x)=0\) 的解？

朱鹭子：对，继续。

琪露诺：说不出来了……

朱鹭子：事实上，是为了保持求导次数一致，我们知道 \(\symscr{L} \) 的表示是：
\[
	\symscr{D} ^n+\sum_{i=1}^{n-1} a_i(t)\symscr{D} _t^i
	.\]

观察到不同阶导前面乘上的函数是不一样的，然而我们要保持 \(\symscr{D} ^n(x_i)+\sum_{i=1}^{n-1} a_i(t)\symscr{D} _t^i (x_i) = 0\) 这个良好的性质，我们需要让 \(\symscr{D} _t^k(x_{\rm Sol})\) 应该对应 \(\symscr{D} _t^k(x_i)\) ，这样子的话，包含所有这些 \(x_i\) 的到时候可以消掉。我们继续，我们现在知道了：
\[
	\symscr{D} _t\left( x_{\rm Sol} \right) =\sum_{i=1}^{n}\symscr{D} _t(x_i)c_i
	.\]

我们继续求导顺便再给出一个条件：
\[
	\symscr{D}^2 _t\left( x_{\rm Sol} \right) =\sum_{i=1}^{n}\symscr{D}^2 _t(x_i)c_i+\underset{\mbox{\tiny 令这个为零}}{\underbrace{\sum_{i=1}^{n}\symscr{D} _t(c_i)\symscr{D} _t(x_i)}}=\sum_{i=1}^{n}\symscr{D}^2 _t(x_i)c_i
	.\]

琪露诺：哇，和第一次求导的时候长得差不多。

朱鹭子：没错，事实上我可以一直这样做，直到我用完了 \(n-1\) 个条件：只要带上 \(\symscr{D} _t(c_i)\) 的求和就让他为零，这样我就可以保证对 \(x_{\rm Sol}\) 的导数阶数和对 \(x_i\) 的导数阶数相等，因此我给出的 \(n-1\) 个条件和推论应该是：
\[
	\begin{bmatrix}
		\sum_{i=1}^{n} \symscr{D} _t(c_i)x_i \\    \sum_{i=1}^{n} \symscr{D} _t(c_i)\symscr{D} _t(x_i) \\    \vdots \\    \sum_{i=1}^{n} \symscr{D} _t(c_i)\symscr{D}^{n-2} _t(x_i) \\\end{bmatrix}=\symbf 0 \implies \begin{bmatrix}
		\symscr{D} _t(x_{\rm Sol}) \\ \symscr{D} ^2_t(x_{\rm Sol})    \\   \vdots  \\    \symscr{D} _t^{n-1}(x_{\rm Sol}) \\\end{bmatrix}=\begin{bmatrix}
		\sum_{i=1}^{n}\symscr{D} _t(x_i)c_i \\    \sum_{i=1}^{n} \symscr{D} _t^2(x_i)c_i \\    \vdots \\  \sum_{i=1}^{n} \symscr{D} _t^{n_-1}(x_i)c_i   \\\end{bmatrix}
	.\]
接下来，我把他带进 \(\symscr{L} (x_{\rm Sol})=\symscr{D} _t^n(x_{\rm Sol})+ \sum_{i=1}^{n-1} a_i(t)\symscr{D} _t^i(x_{\rm Sol})\)，你就能发现我们是怎么对付“求导”这个最大的不稳定因素的：
\[
	\symscr{L} (x_{\rm Sol}) =\symscr{D} _t^n(x_{\rm Sol}) +\sum_{i=1}^{n-1} a_i(t)\symscr{D} _t^i(x_{\rm Sol}) =\symscr{D} _t\left(  \symscr{D} _t^{n-1}(x_{\rm Sol}) \right) + \sum_{i=1}^{n} a_i(t)
	\sum_{j=1}^{n} c_j\symscr{D} _t^j(x_j)\tag{$\mathrm{SOL}^n$}
	.\]

琪露诺：看起来非常复杂……虽然你只是把所有东西都代进去而已，但是这个二重求和……

朱鹭子：确实，但是在这里我们可以先互换啊\emoji{😀}：
\[
	\begin{aligned}
		(\mathrm{SOL}^n) & = \underset{\symscr{D} _t\left(\sum_{j=1}^{n} \symscr{D} _t^{n_-1}(x_j)c_j   \right) \,=\, \sum_{j=1}^{n}\symscr{D} ^n_t(x_j)c_j+\symscr{D} _t^{n-1}(x_j)\symscr{D} (c_j)}{\underbrace{\symscr{D} _t\left(  \symscr{D} _t^{n-1}(x_{\rm Sol}) \right)}} + \sum_{i=1}^{n} a_i(t)
		\sum_{j=1}^{n} c_j\symscr{D} _t^j(x_j)                                                                                                                                                                                                                                                               \\
		                 & =\sum_{j=1}^{n}\symscr{D} ^n_t(x_j)c_j+\symscr{D} _t^{n-1}(x_j)\symscr{D}_t (c_j)+\sum_{j=1}^{n} c_j\sum_{i=1}^{n} a_i(t)
		\symscr{D} _t^j(x_j)                                                                                                                                                                                                                                                                                 \\
		                 & =\underset{\sum_{j=1}^{n} c_j\symscr{L} (x_j)=0}{\underbrace{\sum_{j=1}^{n} c_j\left( \symscr{D} _t^n(x_j)+\sum_{i=1}^{n} a_i(t)\symscr{D} _t^i(x_j) \right)}}+\sum_{j=1}^{n}\symscr{D} _t^{n-1}(x_j)\symscr{D} _t(c_j)=\sum_{j=1}^{n}\symscr{D} _t^{n-1}(x_j)\symscr{D} _t(c_j).
	\end{aligned}
\]

琪露诺：\emoji{😪😪😪😪😪}

朱鹭子：别担心，虽然看起来很复杂，但最后的结果其实相当简单啊：
\[
	\symscr{L} (x_{\rm Sol})=\sum_{j=1}^{n}\symscr{D} _t^{n-1}(x_j)\symscr{D} _t(c_j) =f(t)
	.\]

琪露诺：那这有什么用呢？

朱鹭子：看，我们刚才给出了 \(n-1\) 个方程，但实际上我们要解出 \(c_i\) 必然还需要一个，而 \(x_{\rm Sol}=\sum_{i=1}^{n} x_i(t) c_i(t)\) 并不能算解出 \(c_i\) 的方程，因为我们本身就要解出 \(c_i\) 才知道 \(x_{\rm Sol}\) 的，而这 \(\sum_{j=1}^{n}\symscr{D} _t^{n-1}(x_j)\symscr{D} _t(c_j) =f(t)\)就是最后的方程，如果把这个方程和我们写出来的那 \(n-1\)方程一起写出来：
\[
	\begin{bmatrix}
		\sum_{i=1}^{n} \symscr{D} _t(c_i)x_i \\    \sum_{i=1}^{n} \symscr{D} _t(c_i)\symscr{D} _t(x_i) \\    \vdots \\    \sum_{i=1}^{n} \symscr{D} _t(c_i)\symscr{D}^{(n-2)} _t(x_i) \\
		\sum_{i=1}^{n} \symscr{D} _t(c_i)\symscr{D}^{(n-1)} _t(x_i)
	\end{bmatrix}= \begin{bmatrix}
		0 \\    0 \\    \vdots \\    0 \\    f(t) \\\end{bmatrix}
	.\]

看到这个你想到了什么没有，尤其是左边矩阵里面这个求和？

琪露诺：看起来……是矩阵相乘？

朱鹭子：没错确实是矩阵相乘，实际上：
\[
	\begin{bmatrix}
		\sum_{i=1}^{n} \symscr{D} _t(c_i)x_i \\    \sum_{i=1}^{n} \symscr{D} _t(c_i)\symscr{D} _t(x_i) \\    \vdots \\    \sum_{i=1}^{n} \symscr{D} _t(c_i)\symscr{D}^{(n-2)} _t(x_i) \\
		\sum_{i=1}^{n} \symscr{D} _t(c_i)\symscr{D}^{(n-1)} _t(x_i)
	\end{bmatrix}= \underset{\symbfscr W(t)}{\underbrace{\begin{bmatrix}
				x_1                      & x_2                      & \cdots & x_n                      \\
				\symscr{D} _t(x_1)       & \symscr{D} _t(x_2)       & \cdots & \symscr{D} _t(x_n)       \\
				\vdots                   & \vdots                   &        & \vdots                   \\
				\symscr{D}^{n-1} _t(x_1) & \symscr{D}^{n-1} _t(x_2) & \cdots & \symscr{D}^{n-1} _t(x_n) \\
			\end{bmatrix} }}\cdot \begin{bmatrix}
		\symscr{D} _t(c_1) \\   \symscr{D} _t(c_2) \\    \vdots \\    \symscr{D} _t(c_n) \\\end{bmatrix}=\begin{bmatrix}
		0 \\      \vdots \\    0 \\    f(t) \\\end{bmatrix}
	.\]

琪露诺：噢噢噢噢噢噢噢噢哦哦哦哦哦哦哦！！！！！！！！！！！！我懂了！！！所以你的意思是说，由于 \(x_1,\cdots ,x_n\) 一开始就是线性无关的，所以 \(\symbfscr W\) 的行列式必然恒不为零，所以它必然恒有逆！

朱鹭子：在区间 \(\symcal{I} \) 上。没错，所以这样子我们就可以知道：
\[
	\begin{bmatrix}
		\symscr{D} _t(c_1) \\   \symscr{D} _t(c_2) \\    \vdots \\    \symscr{D} _t(c_n) \\\end{bmatrix} = \symbfscr W^{-1}(t)\cdot\begin{bmatrix}
		0 \\      \vdots \\    0 \\    f(t) \\\end{bmatrix}
	.\]

然后观察到 \(f(t)\) 对应的向量只有最后一个元素，因此实际上只有 \( \symbfscr W^{-1}(t)\) 的最后一列是有用的，因此利用Cramer法则（我们求解的是 \( \symscr{D} _t(c_i)\)所以最后还要积分一下）就可以化成：
\[
	x_{\rm Sol}= \sum_{i=1}^{n} x_i(t) \, \cdot \int\left(  \raisebox{-2.5em}{\(\dfrac{{
					\begin{vmatrix}
						\scriptstyle x_1(t)         & \scriptstyle x_2(t)                       & \scriptstyle \cdots & \scriptstyle 0      & \scriptstyle \cdots & \scriptstyle x_n(t)                     \\[-3pt]
						\scriptstyle x_1'(t)        & \scriptstyle x_2'(t)                      & \scriptstyle \cdots & \scriptstyle 0      & \scriptstyle \cdots & \scriptstyle x_n'(t)                    \\[-3pt]
						\scriptstyle \vdots         & \scriptstyle \vdots                       & \scriptstyle \cdots & \scriptstyle \vdots & \scriptstyle \cdots & \scriptstyle \vdots                     \\[-3pt]
						\scriptstyle x_1^{(n-1)}(t) & \!\! \!\scriptstyle x_n^{(n-1)}(t) \!\!\! & \scriptstyle \cdots & \scriptstyle 1      & \scriptstyle \cdots & \!\! \!\scriptstyle x_n^{(n-1)}(t) \!\! \\[3pt]
					\end{vmatrix}\kern-4em\raisebox{1.8em}{$\kern-8em\overset{i}{\overbrace{\phantom{zzxvxvxvxx3wixcb}}}$\kern 4.6em}}}{\symscr{W} (t)}\)}f(t) \right) \,\mathrm{d}t
	.\]

琪露诺：原来是这样……但是感觉无论是对人类还是对妖怪来说计算量都是太大了吧？

朱鹭子：那我们看看二阶的情况？

琪露诺：二阶的话也是代进去嘛，不过倒是有计算可行性：
\[
	x_{\rm Sol}= x_1(t)\int \dfrac{-x_2(t)f(t)}{\symscr{W}(t)}  \,\mathrm{d}t+x_2(t)\int \dfrac{x_1(t)f(t)}{\symscr{W}(t) } \,\mathrm{d}t
	.\]

看起来正常多了，虽然解一个二阶方程用Cramer法则就是有大病。

朱鹭子：但至少能写出来嘛，能写出一条公式出来不是很美妙的事情吗？

琪露诺：\textbf{*不}。而且这种方法要求我们知道基本解组，这要求我们对齐次的方程了如指掌才行。

朱鹭子：确实……求这些一般是很难的……在这里将给出一个比较重要的种类，那就是常系数齐次微分方程。经过之前的讨论，我们知道只要求出线性微分方程的基本解组就能得出其非齐次方程的解，这样子我们只需要考虑基本解组就可以了。

\subsection{常系数线性微分方程的基本解组}

朱鹭子：对于任意一个线性方程，我们不可能得到它的基本解组，但是如果 \(\symscr{L} \) 是不随时间改变而改变的，即 \(\symscr{L} \) 中所有的 \(a_i(t)\) 都是常数，那么这样一个方程我们是很容易得到它的基本解组的。

琪露诺：果然还是只能搞最基本简单的方程啊……

朱鹭子：的确是这样，我们看下面这个方程：
\[
	\symscr{L}_c (x)\coloneq\symscr{D} _t^n(x)+ \sum_{i=1}^{n-1} a_i\symscr{D} ^i_t(x)=0
	.\]
我们称为常系数线性齐次微分方程。

琪露诺：变成了常数之后应该好搞很多吧？

朱鹭子：是，我们不妨考虑 \( x =\symrm{e} ^{\lambda t}\) 。至于为什么要这么设，实际上是因为对于一阶的：\( \dx+ax=0\) 的解是 \(x= c_1\symrm{e} ^{-at}\) ，所以我们照葫芦画瓢：
\[
	\symscr{L}_c (x) = \symscr{D} _t^n\left( \symrm{e} ^{\lambda t} \right) + \sum_{i=1}^{n-1} a_i\symscr{D} ^i_t\left( \symrm{e} ^{\lambda t} \right)
	=\left( \lambda ^n+ \sum_{i=1}^{n-1} a_i \lambda ^i \right)\symrm{e} ^{\lambda t}=0\implies \lambda ^n+ \sum_{i=1}^{n-1} a_i \lambda ^i =0
\]

琪露诺：哇！变成最基本的代数方程了！接下来不就是解那个 \(n\) 阶方程就可以了吗？

朱鹭子：实际上也没有这么简单，这个方程被称为常系数线性齐次方程组的特征方程，事实上：
\begin{enumerate}
	\setcounter{enumi}{0}
	\item 如果方程 \(\lambda ^n+ \sum_{i=1}^{n-1} a_i \lambda ^i =0\) 有 \(n\) 个不同的解 \(\lambda_1,\cdots ,\lambda _n \) 那么这个常系数线性齐次分方程的基本解组就是 \( \symrm{e} ^{\lambda_1t},\cdots ,\symrm{e} ^{\lambda_nt}\)。
\end{enumerate}

琪露诺：这不是没什么问题吗？

朱鹭子：但实际上，这只是最好的情况，如果特征方程有重根呢？

琪露诺：啊？那也不一样……等等，有重根就意味着实际上这些 \(\symrm{e} ^{\lambda _it}\) 没有 \(n\) 个！那也就是说会有其他解。

朱鹭子：的确，事实上：
\begin{enumerate}
	\setcounter{enumi}{1}
	\item 如果方程 \(\lambda ^n+ \sum_{i=1}^{n-1} a_i \lambda ^i =0\) 有根 \(\lambda_1,\cdots \lambda_k\) 对应重数 \(m_1,\cdots ,m_k\) ，其中 \(\sum_{i=1}^{k} m_i=n\) ，那么这个常系数线性齐次分方程的基本解组就是：
	      \[
		      t^j\symrm{e} ^{\lambda_i t},\,j=0,1,\cdots m_i-1,\,i=1,\cdots k
		      .\]
\end{enumerate}

琪露诺：？这啥，怎么那么多符号，看不懂的啦……

朱鹭子：举个例子，如果特征方程是这样的 \((\lambda -5)^n(\lambda -1)(\lambda -4)^m\) ，那么它对应的常系数线性齐次分方程的基本解组就是：
\[
	\begin{aligned}
		 & \symrm{e} ^{5t},t\symrm{e} ^{5t},\cdots t^{n-1}\symrm{e} ^{5t},  \\
		 & \symrm{e} ^{t},                                                  \\
		 & \symrm{e} ^{5t},t\symrm{e} ^{4t},\cdots ,t^{m-1}\symrm{e} ^{4t}.
	\end{aligned}
\]

琪露诺：这样下去倒的确是 \(n\) 个线性无关解没错了，但为什么是在前面乘上 \(t^i\)  呢？

朱鹭子：常数变易法\emoji{😂}。实际上这个确实不好怎么说明。

琪露诺：又来\emoji{🤔}……

朱鹭子：不妨只设只有一个重根 \(\lambda_1 \) ，重数为 \(m_1\) ，则用常数变易法设这根对应的解是 \( c(t)\symrm{e} ^{\lambda t}\)。则：
\[
	\symscr{D} _t^k (c(t)\symrm{e} ^{\lambda t})=\symrm{e} ^{\lambda t}\sum_{i=0}^{k} \binom{k}{i}\lambda ^i\symscr{D} ^{k-i}_t(c)
	.\]

琪露诺：？这是求 \(k\) 阶导？

朱鹭子：是，事实上这是依赖高阶导数的Leibniz公式：
\[
	\symscr{D} _t^k(a\cdot b)= \sum_{i=0}^{k} \binom{k}{i}\symscr{D} ^{k-i}_t(a)\cdot \symscr{D} ^{i}_t(b)
	.\]

考虑到这个 \(\sum_{i=0}^{k} \binom{k}{i}\lambda ^i\symscr{D} ^{k-i}_t(c)\)也是常系数线性的，那么实际上：
\[
	\begin{aligned}
		\symscr{L} _c(c(t)\symrm{e} ^{\lambda t}) & = \symrm{e} ^{\lambda t}\sum_{i=0}^{n} \binom{n}{i}\lambda ^i\symscr{D} ^{n-i}_t(c)+\sum_{k=1}^{n-1} a_i\symrm{e} ^{\lambda t}\sum_{i=0}^{k} \binom{k}{i}\lambda ^i\symscr{D} ^{k-i}_t(c)         \\
		                                          & =\symrm{e} ^{\lambda t}\underline{\left( \sum_{i=0}^{n} \binom{n}{i}\lambda ^i\symscr{D} ^{n-i}_t(c)+ \sum_{k=1}^{n-1} a_i\sum_{i=0}^{k} \binom{k}{i}\lambda ^i\symscr{D} ^{k-i}_t(c)\right) }=0.
	\end{aligned}
\]

则下划线部分也是常系数线性的，因此不妨设为 \(\overline{\symscr{L} _c}(c)\)。

琪露诺：\emoji{😪😪😪😪😪😪}，计算量太大了吧。

朱鹭子：确实，但我们目的不是为了计算，只要是它是常系数线性的就可以，现在已经变成：
\[
	\symscr{L} _c(c\cdot\symrm{e} ^{\lambda t}) = \overline{\symscr{L} _c}(c)\symrm{e} ^{\lambda t}=0\implies\overline{\symscr{L} _c}(c)=0
	.\]

琪露诺：所以我们要解一个新的常系数线性？

朱鹭子：当然不可能直接解，为了方便讨论，我们不妨设两个线性算符的对应的特征方程为：
\[
	\begin{aligned}
		\symscr{L} : \lambda ^n +\sum_{i=1}^{n-1} a_i \lambda ^i\eqcolon A(\lambda ), \\
		\overline{\symscr{L}} : \lambda ^n +\sum_{i=1}^{n-1} b_i \lambda ^i\eqcolon B(\lambda ).
	\end{aligned}
\]

琪露诺：诶为什么这个超级怪的 \( \overline{\symscr{L} }\) 的 \(n\) 阶导数前面的系数也是 1 呢？

朱鹭子：这个啊，仔细看上面这个方程：
\[
	B(\lambda )=\underline{\sum_{i=0}^{n} \binom{n}{i}\lambda ^i\symscr{D} ^{n-i}_t(c)}+ \sum_{k=1}^{n-1} a_i\sum_{i=0}^{k} \binom{k}{i}\lambda ^i\symscr{D} ^{k-i}_t(c)
	.\]

实际上能产生 \(n\) 阶导数的也只有下换线部分吧？你把 \(i=0\)代进去即可，其他看起来很恐怖，但是其实都是常数（只不过很复杂）罢了，这里我们完全可以不考虑。接下来就是线性算符和特征方程之间的关系：
\[
	\symscr{L} (\symrm{e} ^{kx})=A(k)\symrm{e} ^{kx},\,\overline{\symscr{L}} (\symrm{e} ^{kx})=B(k)\symrm{e} ^{kx}
	.\]

琪露诺：对，因为 \(\symrm{e} ^{kx}\) 求导不会变，所以完全可以提出来，再加上求导算符乘上的都是常数，所以最后实际上变成了一个 \(\symrm{e} ^{kx}\) 乘上一个固定多项式的情形。

朱鹭子：没错，接下来是重点，要知道我们还有这个哇：
\[
	\symscr{L} (c \cdot \symrm{e} ^{kx})=\overline{\symscr{L} }(c)\symrm{e} ^{kx}
	.\]

注意到 \(\overline{\symscr{L} }\) 的定义虽然复杂，但实际上并没有和 \(t\) 有关系，也就是说不管是什么样的函数 \(c\) 上式都是满足的。

琪露诺：看起来好像有点形状了……但是我令 \(c=t^i\) 并不能得到什么哇？

朱鹭子：接下来看：
\[
	\symscr{L} ( \symrm{e} ^{k x}\cdot \symrm{e} ^{\lambda x})=\overline{\symscr{L} }(\symrm{e} ^{k x})\symrm{e} ^{\lambda x}=\underline{B(k)\symrm{e} ^{(k+\lambda )x}}
	.\]

同时
\[
	\symscr{L} ( \symrm{e} ^{k x}\cdot \symrm{e} ^{\lambda x}) =\underline{ A(\lambda +k)\symrm{e} ^{(k+\lambda )x}}
	.\]

注意下划线部分，我们可以得到：
\[
	A(\lambda +k)=B(k)
	.\]

琪露诺：哇，所以这就是把这个抽象的多项式表达出来了？

朱鹭子：确实，但是还有哦，之前过了，这个 \(\lambda \) 是多项式 \(A\) 的 \(m\)重根，这意味着：
\[
	\symscr{D} _k^i(A(\lambda +k))\bigr|_{k=0} =\symscr{D} _k^i(B(k))\bigr|_{k=0}=0,\,i=0,1,\cdots m-1
	.\]

琪露诺：所以是依靠 \(\lambda \) 是 \(A\) 的 \(m\) 重零点来推出这个的吗？

朱鹭子：的确，所以你也看到了， \(0\) 是多项式 \(B(k)\) 的 \(m\) 阶零点，因此？

琪露诺：啊？这不又会到了一开始有多重根的情况了吗？

朱鹭子：看起来好像是这样子，但实际上不一样哦，如果 \(B(k)\) 是这样子的话，那不就意味着 \(B(k)\) 的形式是：
\[
	k^n+\sum_{i=m}^{n-1} b_ik^i
	.\]

对应的常系数线性微分方程实际上就变成：
\[
	\symscr{D} ^n_t(x)+\sum_{i=m}^{n-1} b_i \symscr{D} ^i_t(x)=0
	.\]

琪露诺：诶？是可以等价的吗，原来还可以从特征方程反推常系数微分方程的哇。

朱鹭子：为什么不可以呢？还记得我们最初的特征方程怎么得到的吗：
\[
	\symscr{L} _c \coloneq\symscr{D} ^n_t+ \sum_{i=1}^{n-1} a_i\symscr{D} _t^i \implies\mbox{特征方程}= \lambda  ^n+ \sum_{i=1}^{n-1} a_i\lambda^i
	.\]

这不全是一对一的吗？你不用担心说什么奇怪的 \(\symrm{e} ^{kt}\)变换会害了方程，让它脱离和常系数微分方程的关系，实际上没这回事。

琪露诺：诶？原来这么神奇，看起来好巧妙……

朱鹭子：那我们继续吧，我们知道为了求解 \(c\) ，我们要面对微分方程是：
\[
	\symscr{D} ^n_t(c)+\sum_{i=m}^{n-1} b_i \symscr{D} ^i_t(c)=0
	.\]

琪露诺：这不还是一个 \(n\) 阶吗？

朱鹭子：对，但是它除了各种各样我们不清楚的指数解，还有其他解哦，你看它最小阶数的导数都是 \(m\) 次捏。

琪露诺：\emoji{🤔🤔🤔🤔🤔🤔🤔🤔🤔}……难不成你指的是：
\[
	1,t,\cdots t^{m-1}
	.\]
这些吗？

朱鹭子：没错，更准确来说是他们的线性组合，所以实际上我们要求的 \(c\) 就是这些了。

琪露诺：但那些指数解不会影响吗？

朱鹭子：不会，由于 \(c\) 是指数，那么 \(c\cdot\symrm{e} ^{\lambda t}\) 也是指数，实际上对应方程 \(\symscr{L} _c(x)=0\) 的另一个指数解，这里完全可以忽略，因为这个解必然包含在\(\symscr{L} _c(x)=0\)的解中，并不会造成影响。更恰当地说，由于 \(A(\lambda +k)=B(k)\) 这个关系的存在，使得两个方程紧紧联系在一起，他们解的差别也仅仅是差个常数罢了。所以对于指数解这种只影响特征多项式的，是丝毫不影响的，都是相互对应的。

琪露诺：好吧，所以因为这样我才可以独立讨论所有重根？

朱鹭子：没错。当然，还有一件事是你要证明：
\[
	t^j\symrm{e} ^{\lambda_i t},\,j=0,1,\cdots m_i-1,\,i=1,\cdots k
	.\]
是（在任何区域上）线性无关的。

琪露诺：看起来是那么地显然……

朱鹭子：你可以尝试下Taylor展开，由于这些函数性质良好，所以可以胡乱来（笑）。

琪露诺：算了，我可没那心情。啊对了，还有个问题，如果根式复根怎么办呢？

朱鹭子：复根啊，你只需要用到Euler三角公式：
\[
	\symrm{e} ^{\symrm{i} b}=\cos b+\symrm{i} \sin b
	.\]
所以实际上对应的是 \(\cos bt\)和\(\sin bt\)……

琪露诺：等等！为什么一个根可以对应两个线性无关…… \(\cos bt\) 和 \(\sin bt\) 应该都是线性无关的吧……除了 \(b=0\) ？

朱鹭子：没错。

琪露诺：那这样子我有 \(n\) 个不同的复根不就对应了 \(2n\) 个线性无关解了吗？

朱鹭子：好问题，事实上，复根总是成对出现的。对于一个多项式 \(P\)：
\[
	P(a +b\symrm{i}  )=0 \iff P(a-b\symrm{i} )=0
	.\]

所以实际上是两个复根同时对应了 \(\cos bt\) 和 \(\sin bt\) 。

琪露诺：为什么复根是成对出现的哇？

朱鹭子：嗯……实际上，对于这样的复根我们管它叫“共轭”……

琪露诺：这些我知道，但是为什么……

朱鹭子：对于一个\textbf{实系数}多项式：
\[
	P(\lambda ) = \sum_{i=1}^{n} a_i \lambda ^i
	.\]

我们可以考虑共轭运算 \(^*\)，由于共轭满足以下性质：
\[
	\begin{aligned}
		 & a^*+b^*=(a+b)^*,                                     \\
		 & (a^n)^*=(a^*)^n,\,a,b\in\symbb{C} ,\,n\in\symbb{R} .
	\end{aligned}
\]

所以实际上：
\[
	P(\lambda^* ) = \sum_{i=1}^{n} a_i (\lambda^* )^i  = \sum_{i=1}^{n}  (a_i\lambda^i ) ^*=\left( \sum_{i=1}^{n}  a_i\lambda^i \right) ^*=P(\lambda )^*
	.\]

因此如果 \(P(r)=0 \iff P(r^*)=0\)。

琪露诺：哇，原来如此。感觉世界一下子那啥起来了。

朱鹭子：那啥……你想说什么……

琪露诺：没。



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\input{brace.tex}
% \input{一阶微分方程的简单换元法.tex}
% \small
\input{存在唯一性定理的推导思路.tex}

\section{二阶线性微分方程的幂级数解法}

\subsection{方程常点邻域内的解}
蓝：由于（非常清楚地）普通的线性方程的基本解组毫无规律可言，因此用级数去近似解也是一种不错的思路。

朱鹭子：照你这么说也是确实……但用级数解法不就得考虑敛散性的问题了么？

蓝：的确，在这里我们只讨论最能接受的二阶线性微分方程：
\[
	\ddw+p(z)\dw+q(z)w=0
	.\]

并且我们给定了在 \(z_0\) 点处的初值条件，那么我们要考虑的其实是在 \(\left\vert z-z_0 \right\vert <R\) 这个圆盘上面的解，事实上：

\begin{tho}{常点附近级数解的存在性}{}
	如果 \(p(z)\) 和 \(q(z)\) 在 \(\left\vert z-z_0 \right\vert <R\)内单值解析，则方程
	\[
		\ddw+p(z)\dw+q(z)w=0
		.\]
	必然存在一个唯一解，且该唯一解在 \(\left\vert z-z_0 \right\vert <R\) 上亦单值解析。
\end{tho}
朱鹭子：解析的话就意味着条件太强了啊……

蓝：事实上这其实代表着 \(p(z)\) 在 \(q(z)\) 在 \(z_0\) 解析的情形，此时这个点被称为方程的\textbf{常点}。

朱鹭子：诶？你的意思是说即使那俩函数在 \(z_0\) 点不解析也是依然可以有解的吗？

蓝：是的，这个我们之后再讨论。由于解 \(w(z)\) 是解析的，那么我们也就可以在 \(\left\vert z-z_0 \right\vert <R\) 上将其展开成\textbf{Taylor级数}：
\[
	w(z)= \sum_{n=0}^{\infty} a_n(z-z_0)^n
	.\]

朱鹭子：看起来我只要把这方程里面的 \(p(z)\) 和 \(q(z)\) 也展开成Taylor级数，代进去就可以得到解的各个系数之间的递推公式。

蓝：看上去的确如此，但不要忘记，这个方程是有两个线性无关解的，因此你得到的递推公式可能会相当乱。

朱鹭子：这倒是。

蓝：我这里倒是有个非常不错的例子：


\begin{tcolorbox}[colback=gray!20,colframe=gray!150,fonttitle=\bfseries,arc=0mm,leftrule=1mm,toprule=0mm,bottomrule=0mm,rightrule=0mm]
	求Airy方程
	\[
		\ddw -zw=0 \tag{Airy}
		.\]
	在 \( \mathring{U}_{\varepsilon }(0)\) 上的解。
	\tcbline

	事实上容易知道这个 \(p(z)\equiv 0\) 和 \(q(z) =z\)在复平面上解析，因此不妨设解 \(w=\sum_{n=0}^{\infty} a_n z^n\)，因此代入方程 (Airy) 可以用得到：
	\[
		\sum_{n=2}^{\infty} a_n n(n-1) z^{n-2}-\sum_{n=0}^{\infty} a_n z^{n+1}=0
		.\]
	整理一下就可以得到：
	\[
		2a_2+\sum_{n=1}^{\infty} ( (n+1)(n+2)a_{n+2}-a_{n-1}t)z^{n}=0
		.\]
	因此由Taylor展开的唯一性可以得到：
	\[
		\begin{cases}
			\\[-2.2em]
			a_2=0， \\
			(n+1)(n+2)a_{n+2}-a_{n-1}=0.
		\end{cases}
	\]
	因此我们得到了递推公式：
	\[
		\begin{cases}
			\\[-2.2em]\
			a_{3n-1}=0,                         \\
			a_{3n}= \dfrac{a_{3n-3}}{3n(3n-1)}, \\
			a_{3n+1}= \dfrac{a_{3n-2}}{3n(3n+1)},
		\end{cases}\, n\in\symbb{N} ^+.
	\]
	因此我们要考量的其实是 \(a_0\) 和 \(a_1\)，实际上这两个系数就对应了方程 (Airy) 的两个线性无关解：
	\[
		a_{3n}= \frac{a_0}{\prod_{i=1}^{n} 3i(3i-1) } = \frac{a_0\prod_{i=1}^{n} (3i-2)}{(3n)!}
		.\]
\end{tcolorbox}

在这里我们不得不借助Γ函数——这个你是知道的吧？


朱鹭子：那是自然。


蓝：那就好，因此：


\begin{tcolorbox}[colback=gray!20,colframe=gray!150,fonttitle=\bfseries,arc=0mm,leftrule=1mm,toprule=0mm,bottomrule=0mm,rightrule=0mm,breakable]
	\[
		a_{3n}=\frac{a_0\prod_{i=1}^{n} (3i-2)}{(3n)!} = \frac{a_0 3^n\prod_{i=1}^{n} \left( i-\frac{2}{3} \right) }{\Gamma (3n+1)}=
		\frac{a_0 3^n \Gamma \left( n+\frac{1}{3} \right)  }{\Gamma (3n+1)\Gamma \left( \frac{1}{3} \right) }
		.\]

	用同样的手法得到：
	\[
		a_{3n+1}=	\frac{a_1 3^n \Gamma \left( n+\frac{2}{3} \right)  }{\Gamma (3n+1)\Gamma \left( \frac{1}{3} \right) }
		.\]

	因此我们就可以得到两个线性无关解：
	\[
		\begin{cases}
			\\[-2.2em]
			w_1(z)= \sum_{n=0}^{\infty} 	\dfrac{3^n \Gamma \left( n+\frac{1}{3} \right)  }{\Gamma (3n+1)\Gamma \left( \frac{1}{3} \right) } z^{3n}, \\[6pt]
			w_2(z)=\sum_{n=0}^{\infty}  \dfrac{3^n \Gamma \left( n+\frac{2}{3} \right)  }{\Gamma (3n+1)\Gamma \left( \frac{1}{3} \right) } z^{3n+1}.
		\end{cases}
	\]

	另外地，我们会设 \(\Ai(z)\coloneq\dfrac{w_1(z)}{3^{\frac{2}{3}} \Gamma \left(\frac{2}{3}\right)}-\dfrac{w_2(z)}{3^{\frac{1}{3}} \Gamma \left(\frac{1}{3}\right)},\,\Bi(z)\coloneq \dfrac{w_1(z)}{3^{\frac{1}{6}}\Gamma \left( \frac{2}{3} \right) }+\dfrac{w_2(z)}{3^{\frac{1}{6}}\Gamma \left( \frac{1}{3} \right) }\)。
\end{tcolorbox}

朱鹭子：诶？为什么要这么设呢？

蓝：事实上是这样的：

\begin{center}
	\includegraphics[]{Ai and Bi func.pdf}
\end{center}

这是两个函数的图像，\(\Ai(z)\) 在 \(z\to +\infty \) 的时候会趋向于0，实际上：
\[
	\Ai(z)\sim \frac{1}{2 \sqrt{\symup\pi }}\cdot \frac{\symrm{e} ^{-{2 z^{3/2}}/{3}}}{ \sqrt[4]{z}},\, z\to +\infty
	.\]

至于 \(\Bi(z)\) 有：
\[
	\Bi(z)\sim\frac{1}{\sqrt{\symup \pi }}\cdot  \dfrac{\symrm{e} ^{2\symrm{z} ^{3/2}/3}}{\sqrt[4]{z}},\, z\to +\infty
	.\]

我们在这里暂时先不讨论当 \(z\to \infty\) 的时候，幂级数解会变成什么样子。

好，这就是方程常点邻域内的解。同时，我们也可以根据需要进行解析延拓。
\subsection{方程极点邻域内的解}
朱鹭子：那如果不是常点呢？

蓝：不是常点那就麻烦多了，我们只讨论极点而不讨论本征奇点了。

\begin{tho}[]{极点附近级数解的存在性}{}
	如果 \(z_0\)是方程的\textbf{孤立极点}，则在 \(\mathring{U}_\varepsilon (z_0)\) 上，存在两个线性无关解：\vspace{2em}
	\[
		\begin{cases}
			\\[-3.5em]
			\begin{cases}
				% \\[-2.2em]\
				\displaystyle w_1(z)=(z-z_0)^{\rho _1}\sum_{n=-\infty}^{\infty} a_n (z-z_0)^n, \\[4pt]
				\displaystyle w_2(z)=(z-z_0)^{\rho _2}\sum_{n=-\infty}^{\infty} b_n (z-z_0)^n.
			\end{cases}           & \rho _1-\rho _2\notin\symbb{Z}.           \\[30pt]
			\begin{cases}
				% \\[-2.2em]\
				\displaystyle w_1(z)=(z-z_0)^{\rho _1}\sum_{n=-\infty}^{\infty} a_n (z-z_0)^n, \\
				\displaystyle w_2(z)=gw_1(z)\ln (z-z_0)+(z-z_0)^{\rho _1}\sum_{n=-\infty}^{\infty} b_n (z-z_0)^n
			\end{cases} & \rho _1-\rho _2\in\symbb{Z}.
			\\[-1.5em]
		\end{cases}
	\]
	\vspace{0em}
\end{tho}

请允许我说明一些事情，就是这个 \(w_1(z)\ln (z-z_0) \) 的来源。

朱鹭子：请。

蓝：这段东西可能会很长，我会用一个小型盒子把它包起来。

\begin{tcolorbox}[colback=gray!20,colframe=gray!150,fonttitle=\bfseries,arc=0mm,leftrule=1mm,toprule=0mm,bottomrule=0mm,rightrule=0mm,breakable]
	\setlength{\lineskip}{5pt}
	\setlength{\lineskiplimit}{2.5pt}
	首先我们要证明的是，若 \(w_1\) 是方程：
	\[
		\symscr{D} _t^2(w)+p(z)\dw+q(t)w=0
		.\]
	的解，而且在区域 \(\symcal{I}_1\) 上解析，那么如果 \( W_1\) 是 \(w_1\) 在 \(\symcal{I} _2\) 上面的解析延拓，且 \(\symcal{I} _1 \cap\symcal{I} _2 \neq  \varnothing\)，则 \( W_1\) 是方程在 \(\symcal{I} _2\) 上面的解。
	\begin{tcolorbox}[colback=gray!10,colframe=gray!40,fonttitle=\bfseries,arc=0mm,leftrule=1mm,toprule=0mm,bottomrule=0mm,rightrule=0mm,breakable]
		\color{gray!120}
		这个的证明其实并不难，为了考虑 \( W_1\) 和 \(w_1\) 的差别，不妨构造：
		\[
			D(z)=\symscr{D} _t^2(W_1)+p(z)\symscr{D} _t(W_1)+q(t)W_1
			.\]
		我们的目的就是要证明在 \(\symcal{I} _2\) 上 \(D(z)\equiv 0\)，因为 \(D(z)\) 在\(\symcal{I} _2\) 上解析，所以实际上这个函数是 \(\symscr{D} _t^2(w)+p(z)\dw+q(t)w\) 在 \(\symcal{I} _2\) 上的解析延拓，由于在 \(\symcal{I} _1 \cap\symcal{I} _2 \neq  \varnothing\) 上面 \(D(z)=D(z)=\symscr{D} _t^2(w_1)+p(z)\symscr{D} _t(w_1)+q(t)w_1\equiv 0\)，故由解析延拓可知， \(D(z)\) 在\(\symcal{I} _2\) 也恒为零，因此 \(W_1(z)\) 也是方程的解。
	\end{tcolorbox}
	接下来是证明两个线性无关解 \(w_1,w_2\)的延拓\(W_1,W_2\)线性无关：
	\begin{tcolorbox}[colback=gray!10,colframe=gray!40,fonttitle=\bfseries,arc=0mm,leftrule=1mm,toprule=0mm,bottomrule=0mm,rightrule=0mm,breakable]	\color{gray!120}
		由之前关于Wronsky行列式的讨论知道：
		\[
			\symscr{W} (t) =\symscr{W} (t_0)\exp \left( -\int_{t_0}^t p(s) \,\mathrm{d}s  \right)
			\label{wronskyhlsyupz}
			.\]
		因此考虑由\(\symcal{I}_1\)到 \(\symcal{I} _2\) 的积分路径，事实上由于 \(w_1,w_2\)线性无关，必然对于 \(\forall t_0\in\symcal{I} _1\) 都有 \(\symscr{W} (t_0)\neq 0\) ，因此沿该路线积分后，\(\symcal{I} _2\) 上的任一点也不为零，又因为\(W_1,W_2\)是方程的解，因此他们之间线性无关。
	\end{tcolorbox}
	由上面所述，由于真正的线性无关解就只有 \(w_1,w_2\) 两个，因此它们的延拓可以用其线性组合表示出来（因为其也是方程的解）：
	\[
		\begin{bmatrix}
			W_1 \\    W_2 \\\end{bmatrix} =\symbfit{T}\cdot \begin{bmatrix}
			w_1 \\    w_2 \\\end{bmatrix}
		.\]
	由于 \(W_1,W_2\) 线性无关，因此 \(\left\vert\symbfit{T}  \right\vert \neq 0\)。

	现在我们考虑一种特殊的延拓，那就是 \(w_1,w_2\) 沿着 \(z_0\) 旋转一周时候的解析延拓 \(W_1,W_2\) （依然使用这个记法，后续中我们默认用大写表示解析延拓）。这样做是为了方便讨论 \(w_1,w_2\) 本身的多值性。

	考虑一种特殊的解：
	\[
		w_{\mathrm{m} }= a_1 w_1 +a_2w_2 = \begin{bmatrix}
			a_1 & a_2 \\
		\end{bmatrix}^{\mathrm T}\cdot \begin{bmatrix}
			w_1 \\    w_2 \\\end{bmatrix}
		.\]
	满足：\(W_{\mathrm{m} } = \lambda w_{\mathrm{m}}\)，这样做是为了方便讨论。

	事实上，这样的 \(w_{\mathrm{m}}\) 必然是存在的，因为：
	\[
		W_{\mathrm{m}} =  \begin{bmatrix}
			a_1 & a_2 \\
		\end{bmatrix}^{\mathrm T}\cdot \begin{bmatrix}
			W_1 \\    W_2 \\\end{bmatrix} =  \begin{bmatrix}
			a_1 & a_2 \\
		\end{bmatrix}^{\symrm{T}}\cdot  \symbfit{T} \cdot \begin{bmatrix}
			w_1 \\    w_2 \\\end{bmatrix}= \lambda w_{\mathrm{m}} =\lambda \cdot  \begin{bmatrix}
			a_1 & a_2 \\
		\end{bmatrix}^{\mathrm T}\cdot \begin{bmatrix}
			w_1 \\    w_2 \\\end{bmatrix}
		.\]
	考虑到 \(\begin{bmatrix}
		w_1 \\    w_2 \\\end{bmatrix}\) 是线性无关的，因此 \(\lambda \) 实际上是矩阵 \(\symbfit{T} \) 的特征值，由于\(\left\vert\symbfit{T}  \right\vert \neq 0\)，因此必然存在（而且不为零），只是有无重根的区别罢了。
	\begin{itemize}
		\item 现在先考虑没有重根 \(\lambda_1,\lambda _2\)的情况，此时两个线性无关解中必然有一个多值函数，因为我们按照上面的求法得到了 \(w_{\mathrm m,\lambda_1}\) 与 \(w_{\mathrm m,\lambda _2}\) 必然是线性无关的，否则必然有
		      \[
			      \dfrac{w_{\mathrm m,\lambda_1}}{w_{\mathrm m,\lambda _2}}=c_1 \implies \dfrac{W_{\mathrm m,\lambda_1}}{W_{\mathrm m,\lambda _2}} = \dfrac{\lambda_1 }{\lambda _2}\cdot\dfrac{w_{\mathrm m,\lambda_1}}{w_{\mathrm m,\lambda _2}} = \dfrac{\lambda_1 }{\lambda _2}\cdot c_1
		      \]
		      但同时 \(\dfrac{W_{\mathrm m,\lambda_1}}{W_{\mathrm m,\lambda _2}} \) 也是解析的，事实上它是 \(c_1\) 的解析延拓，因此必然有 \(\dfrac{W_{\mathrm m,\lambda_1}}{W_{\mathrm m,\lambda _2}}\equiv c_1\)，这就得到了 \( \dfrac{\lambda_1}{\lambda _2}=1\) 与两根相异矛盾。

		      因此我们将会得到两个线性无关的 \(W_{\mathrm{m}}\) ，而观察到绕一圈之后其值会有变化（如果没有变化要求 \(\lambda =1\) ，但因为此时讨论 \(\lambda \)有两个不同根的情况，故必然要讨论多值函数）。这意味着我们即使连在 \(z_0 \) 附近将解展开成Laurent级数都做不到。

		      但另外一件事是这个函数：
		      \[
			      g(z)\coloneq (z-z_0)^{ \frac{\ln \lambda }{2\symup \pi\symrm{i} }}
			      .\]
		      当然正常情况下是多值的，其绕 \(z_0\)一圈后的延拓 \(G(z) = \exp\left( 2\symup \pi \symrm{i} \cdot  \dfrac{\ln \lambda }{2\symup \pi\symrm{i} }\right)\cdot (z-z_0)^{ \frac{\ln \lambda }{2\symup \pi\symrm{i} }}=\lambda g(z)\)，这意味着如果 \(w_{\mathrm{m}}\) 和 \(g(z)\) 同时绕 \(z_0\) 一圈进行延拓，那么他们的商会互相抵消，也就是：
		      \[
			      \dfrac{w_{\mathrm{m}}}{g(z)}\, \mbox{是单值的}
			      .\]
		      又由于解析性，因此我们可以认为 \(\dfrac{w_{\mathrm{m}}}{g(z)}\)在整个延拓域（包括原域）都是\textbf{单值解析}的，那么就可以将其展开成Laurent级数：
		      \[
			      \dfrac{w_{\mathrm{m}}}{g(z)}=\sum_{n=-\infty}^{\infty} a_n (z-z_0)^n \implies w_{\mathrm{m}} = (z-z_0)^{ \frac{\ln \lambda }{2\symup \pi\symrm{i} }} \sum_{n=-\infty}^{\infty} a_n (z-z_0)^n
			      .\]
		      由于这样的 \(w_{\mathrm{m}}\) 有两个，不妨设 \( \rho =  \dfrac{\ln \lambda }{2\symup \pi\symrm{i} }\) ，则就得到了我们定理的第一部分：
		      \[
			      \begin{cases}
				      \displaystyle w_1(z)=(z-z_0)^{\rho _1}\sum_{n=-\infty}^{\infty} a_n (z-z_0)^n, \\[4pt]
				      \displaystyle w_2(z)=(z-z_0)^{\rho _2}\sum_{n=-\infty}^{\infty} b_n (z-z_0)^n.
			      \end{cases}  \, \rho _1-\rho _2\notin\symbb{Z}.
		      \]
		      这里的 \(\rho _1-\rho _2\notin\symbb{Z}\) 是为了让 \( \exp (2\symup \pi \symrm{i} \rho_1 )\neq\exp (2\symup \pi \symrm{i} \rho_2 )\) ，即 \(\lambda_1\neq \lambda _2\)。
		\item 现在来考虑如果矩阵 \(\symbfit{T} \) 的特征值有重根的情形：此时我们只能找到一个 \(w_{\mathrm{m},\lambda_1}\) ，为了找到另外的解 \(w_{\rm a}\)（且与 \(w_{\mathrm{m},\lambda_1 }\) 线性无关，我们考虑：
		      \[
			      W_{\rm a} = \begin{bmatrix}
				      b_1 & b_2 \\\end{bmatrix}^{\symrm{T} } \cdot \begin{bmatrix}
				      w_{\mathrm{m},\lambda_1} \\    w_{\rm a} \\\end{bmatrix}
			      .\]
		      此时实际上是用 \(w_{\mathrm{m},\lambda_1}\) 和 \(w_{\rm a}\) 两个函数作为基来表示微分方程的解空间，
		      \[
			      \begin{bmatrix}
				      W_{\mathrm m,\lambda_1 } \\  W_{\rm a}   \\\end{bmatrix}=\symbfit{T}_{\rm new} \cdot   \begin{bmatrix}
				      w_{\mathrm{m},\lambda_1} \\    w_{\rm a} \\\end{bmatrix}=\begin{bmatrix}
				      \lambda_1 & b_1 \\
				      0         & b_2 \\
			      \end{bmatrix}\cdot \begin{bmatrix}
				      w_{\mathrm{m},\lambda_1 } \\    w_{\rm a} \\\end{bmatrix}
			      .\]
		      考虑到我们为了找到 \(w_{\mathrm{m}}\) 在这个矩阵下面的表示，我们要求它的特征值，但是 \( w_{\mathrm{m}}\) 对应的特征值是不会矩阵 \(\symbfit{T} \) 和 \( \symbfit T_{\rm new}\)  所影响，因此 \( \symbfit T_{\rm new}\) 的特征值依然是 \( \lambda_1\) 这样实际上就是：
		      \[
			      \left\vert \symbfit T_{\rm new}- \lambda \symbfit E \right\vert = 0 \implies(\lambda_1-\lambda )(b_2-\lambda )=0
			      .\]
		      我们清楚知道 \(\lambda_1\) 是二重根，因此 \(b_2=\lambda_1\)。这就意味着：
		      \[
			      W_{\rm a}=a_1 w_{\mathrm{m},\lambda_1}+ w_{\rm a}
			      .\]
		      以及
		      \[
			      W_{\mathrm{m},\lambda_1}= \lambda_1w_{\mathrm{m},\lambda_1}
			      .\]
		      得到：
		      \[
			      \frac{W_{\rm a}}{W_{\mathrm{m},\lambda_1}}= \frac{w_{\rm a}}{w_{\mathrm{m},\lambda_1}}+ \frac{b_1}{\lambda_1}
			      .\]
		      这就意味着函数 \(\dfrac{w_{\rm a}}{w_{\mathrm{m},\lambda_1}}\) 绕 \(z_0\) 点一周之后，它的值会增加 \( \dfrac{b_1}{\lambda_1}\)，实际上 \( \dfrac{b_1}{\lambda_1} \cdot \dfrac{\ln (z-z_0)}{2\symup \pi \symrm{i} }\) 也是如此，因此：
		      \[
			      \frac{w_{\rm a}}{w_{\mathrm{m},\lambda_1}}-\dfrac{b_1}{\lambda_1} \cdot \dfrac{\ln (z-z_0)}{2\symup \pi \symrm{i} }\,\mbox{是单值的}
			      .\]
		      然后把它展开成Laurent级数：

	\end{itemize}
	\[
		\frac{w_{\rm a}}{w_{\mathrm{m},\lambda_1}}-\dfrac{b_1}{\lambda_1} \cdot \frac{\ln (z-z_0)}{2\symup \pi \symrm{i} }=\sum_{n=-\infty}^{\infty} c_n (z-z_0)^n\implies w_{\rm a} =gw_{\mathrm{m},\lambda_1}\ln (z-z_0)+(z-z_0)^{\rho _1}\sum_{n=-\infty}^{\infty} d_n (z-z_0)^n
		.\]
\end{tcolorbox}
到这里就结束了。

朱鹭子：好！酣畅淋漓！但是我有一些问题，首先，我们是要知道具体的 \(\rho _1\) 和 \(\rho _2\) 长什么样子才能知道这个解的形式到底有无对数，而要求 \(\rho _1\)和 \(\rho _2\) 就必须要求得解的形式，这是否算一种循环？另外一件事情是，经过上面的讨论，其实和 \(p(z),q(z)\) 在 \(z_0\) 点的解析性无关，为何当他们都是解析函数的时候，微分方程的解没有对数项？

蓝：好问题，事实上 \(\rho _1\) 与 \(\rho _2\) 我们有办法在不求出解的形式而进行讨论，这点后面在说明，至于为什么解析的方程的解也是解析的，此处我做一些简短的说明。

事实上，这个二阶微分方程其实等价求解：
\[
	\ddw= - p(z)\dw-q(z)w
	.\]
不妨设 \(u=\dw\) ，则不妨认为 \(u\) 是下面问题的解：
\[
	\symscr{D} _z(u) = -p(z) u - q(z) w
	.\]

此时看起来像个正常的一阶方程，但实际上 \(w\) 的存在性不明，因此我们依然要想办法找个函数序列趋近 \(w\)，事实上我们完全可以：
\[
	\begin{cases}
		\symscr{D} _z(u) = -p(z) u - q(z) v , \\
		\symscr{D} _z(v) = -\dfrac{\symscr{D} _z(u)}{p(z)}- \dfrac{q(z)}{p(z)} v.
	\end{cases}
\]

事实上 \(u\) 和 \(v\) 分别对应了解 \(\dw\) 和 \(w\)（如果存在的话），因此在有初值条件：
\[
	w(z_0)=w_0,\,w'(z_0)=w_0'
	.\]

因此我们就可以按照以下方法进行迭代：
\[
	\begin{aligned}
		 & u_0 = w_0'                                                                                                \\
		 & v_0=w_0                                                                                                   \\
		 & u_{n+1}(z) = w_0'-\int_{z_0}^z \left( p(s) u_n(s) + q(s) v_n(s) \right) \,\mathrm{d}s                     \\
		 & v_{n+1}(z) = w_0-\int_{z_0}^z \left( \dfrac{u_n(s) }{p(z)}+\dfrac{q(z)}{p(z)}v_n(s) \right) \,\mathrm{d}s
	\end{aligned}
	.\]

然后再证明 \(u_i\) 和 \(v_i\) 都存在极限 \(u_{\rm m}\) 和 \(v_{\rm m}\)，此就代表了二阶线性方程满足初值条件的解，具体证法可以参照一阶微分方程存在性定理的Picard证法（当然此处还要证明解析，但实际上只要求证明某些序列比如 \(u_{n+1}-u_{n}\)一致收敛即可），此处不再赘述。

朱鹭子：那也算行，现在的问题是，你这个定理，它得到的那个 Laurent 级数的幂是从负无穷到正无穷，这样做是否会……

蓝：是，会非常麻烦，比如看看：
\[
	\sum_{n=-\infty}^{\infty} \frac{a_{n+2}(z-z_0)^n}{(\rho _1+n)(\rho _1+n-1)} +\underline{\sum_{n=-\infty}^{\infty} \sum_{j=-k}^{\infty}}\frac{a_{n+1}b_j(z-z_0)^{n+j}}{\rho _1+n}  +\underline{\sum_{n=-\infty}^{\infty} \sum_{j=-m}^{\infty}} a_n c_j (z-z_0)^{n+j}=0
	.\]

下划线部分的两个求和并没有什么好的处理方法，因为有一个从负无穷到正无穷的积分，你没有办法利用Cauthy乘积化简：
\[
	\sum_{n=0}^{\infty} a_k \cdot \sum_{n=0}^{\infty} b_k = \sum_{n=0}^{\infty} \left( \sum_{i=0}^{n} a_i b_{n-i} \right)
	.\]

在这里做是没有意义的，因为你依然会得到一个含有无穷求和的方程才能确定 \(z^i\) 的系数。

朱鹭子：原来如此，那怎么样才能化简这个呢？

蓝：暂时没有什么好的方法。

朱鹭子：\emoji{😂}。啊这……

蓝：但有另外一种类型的方程，这种方程的解是正常的：
\vspace{1em}
\[
	\begin{cases}
		% \\[-2.2em]\
		\displaystyle w_1(z)=(z-z_0)^{\rho _1}\sum_{n=0}^{\infty} a_n (z-z_0)^n, \\
		\displaystyle w_2(z)=gw_1(z)\ln (z-z_0)+(z-z_0)^{\rho _2}\sum_{n=0}^{\infty} b_n (z-z_0)^n,
	\end{cases}\quad  \rho _1-\rho _2\in\symbb{Z}.
\]
\vspace{0em}

注意到这些解并不是从负无穷开始求和的，因此我们有希望求出它们的解，此时的解被称为\textbf{正则的}。正则的就是好的。

朱鹭子：正则的就是好的。

蓝：\emoji{✔}

蓝：当然此时 \(z_0\) 依然是方程的奇点，但是由于可以诱导正则解，所以是\textbf{正则奇点}。

朱鹭子：正则的就是好的。

蓝：\emoji{✔}

朱鹭子：那正则奇点有满足上面条件呢，就那个微分方程？

蓝：事实上这个方程是有充要条件的：
\begin{tho}{二阶线性微分方程有两个线性无关正则解的充要条件}{}
	对于方程
	\[
		\ddw+p(z)\dw+q(z)w=0
		.\]
	在 \(z_0\) 邻域内有两个线性无关的正则解的充要条件是 \((z-z_0)p(z)\) 和 \((z-z_0)^2 q(z)\) 在 \(z_0\) 点解析。
\end{tho}


由\hyperref[wronskyhlsyupz]{\underline{这里的讨论}}我们知道：
\[
	\begin{aligned}
		\symscr{W} (z) & =\symscr{W} (z_0)\exp \left( -\int_{z_0}^z p(s) \,\mathrm{d}s  \right) \implies p(z) =-\symscr{D} _z\left( \ln \left( \frac{\symscr{W} (z)}{\symscr{W} (z_0)} \right)  \right)    \\
		               & =-\symscr{D} _z (\ln (w_1\symscr{D} _z(w_2)-w_2\symscr{D} _z(w_1))) = -\symscr{D} _z\left( \ln \left( w_1^2\cdot \symscr{D} _z\left(  \frac{w_2}{w_1} \right)  \right)  \right) .\end{aligned}
\]

然后可以尝试下一股脑代进去，就用上面正则解的形式：

\footnotesize
\[\color{gray}
	\begin{aligned}
		p(z) & =-\symscr{D} _z\left( \ln \left( w_1^2\cdot \symscr{D} _z\left(  \frac{w_2}{w_1} \right)  \right)  \right)                                                                                                                                   \\
		     & =-\symscr{D} _z\left( \ln \left( w_1^2\cdot \symscr{D} _z\left(  \frac{gw_1(z)\ln (z-z_0)+(z-z_0)^{\rho _2}\sum_{n=0}^{\infty} b_n (z-z_0)^n}{(z-z_0)^{\rho _1}\sum_{n=0}^{\infty} a_n (z-z_0)^n} \right)  \right)  \right)                  \\
		     & =-\symscr{D} _z\left( \ln \left( w_1^2\cdot \symscr{D} _z\left( g \ln (z-z_0)+ (z-z_0)^{\rho _2-\rho _1}\frac{\sum_{n=0}^{\infty} b_n (z-z_0)^n}{\sum_{n=0}^{\infty} a_n (z-z_0)^n} \right)  \right)  \right)                                \\
		     & =-\symscr{D} _z\left( \ln \left( w_1^2\cdot \symscr{D} _z\left( g \ln (z-z_0)+ (z-z_0)^{\rho _2-\rho _1} \sum_{n=0}^{\infty} k_n (z-z_0)^n \right)  \right)  \right)                                                                         \\
		     & =-\symscr{D} _z\left( \ln \left( w_1^2\cdot \left( \frac{g}{z-z_0}+ (z-z_0)^{\rho _2-\rho _1} \sum_{n=0}^{\infty} (\rho _2-\rho _1+n)k_n (z-z_0)^n \right)  \right)  \right)                                                                 \\
		     & =-\symscr{D} _z\left( \ln \left( (z-z_0)^{2\rho _1}\left( \sum_{n=0}^{\infty} a_n (z-z_0)^n \right)^2 \cdot \left( \frac{g}{z-z_0}+ (z-z_0)^{\rho _2-\rho _1} \sum_{n=0}^{\infty} (\rho _2-\rho _1+n)k_n (z-z_0)^n \right)  \right)  \right) \\
		     & =-\symscr{D} _z\left( \ln \left( \sum_{n=-1}^{\infty} A_n (z-z_0)^{n+2\rho _1}  + (z-z_0)^{\rho _2+\rho _1} \sum_{n=0}^{\infty}B_n(z-z_0)^n \right)  \right)                                                                                 \\
		     & =- \frac{\sum_{n=-1}^{\infty} C_n (z-z_0)^{n+2\rho _1-1}  + (z-z_0)^{\rho _2+\rho _1} \sum_{n=0}^{\infty}D_n(z-z_0)^{n-1}}{\sum_{n=-1}^{\infty} A_n (z-z_0)^{n+2\rho _1}  + (z-z_0)^{\rho _2+\rho _1} \sum_{n=0}^{\infty}B_n(z-z_0)^n}
	\end{aligned}
	.\]

因此：
\[
	zp(z)=- \frac{\sum_{n=-1}^{\infty} C_n (z-z_0)^{n+2\rho _1}  + (z-z_0)^{\rho _2+\rho _1} \sum_{n=0}^{\infty}D_n(z-z_0)^{n}}{\sum_{n=-1}^{\infty} A_n (z-z_0)^{n+2\rho _1}  + (z-z_0)^{\rho _2+\rho _1} \sum_{n=0}^{\infty}B_n(z-z_0)^n}
	.\]
\normalsize
在 \(z_0\) 是可去奇点，又因为分母分子解析，所以这玩意实际上就是在 \(z_0\) 邻域内解析，故 \(zp(z)\) 在 \(z_0\) 邻域内解析。至于 \(q(z)\)……

实际上：
\[
	q(z)=- \frac{\symscr{D} _z^2(w_1)}{w_1}-p(z) \frac{\symscr{D} _z(w_1)}{w_1}
	.\]

且由于上面的讨论得到 \(z_0\) 是 \(p(z)\) 的最多一阶极点，因此可以得到 \(z_0\) 是 \(q(z)\) 的最多二阶极点。因此就完成了必要性的证明。

朱鹭子：别写了，没人会看计算过程的，提及一下即可。

蓝：好，接下来是充分性由于时间问题暂且不论了，接下来我们要讨论的是如何求出 \(\rho _1\) 和 \(\rho _2\) ，这被称为方程在正则奇点处的\textbf{指标}。为了方便讨论，以后不妨设 \(\Re(\rho _1)\geqslant \Re(\rho _2)\)。

由于解的形状是就是那两种，而那个 \(\ln (z-z_0)\) 是不会影响 \((z-z_0)\) 的幂的，因为不能展开，因此我们不妨设解的形式为：
\[
	w(z) = (z-z_0)^{\rho } \sum_{n=0}^{\infty} w_n(z-z_0)^n
	.\]

同时我们也将 \(p(z)\) 和 \(q(z)\) 展开：
\[
	p(z)=\sum_{n=0}^{\infty} p_n (z-z_0)^{n-1},\,q(z)= \sum_{n=0}^{\infty} q_n (z-z_0)^{n-2}
	.\]

一股脑代进去就可以得到：
\[
	\begin{aligned}
		    & (z-z_0)^{\rho } \sum_{n=0}^{\infty}(n+\rho )(n+\rho -1) w_n(z-z_0)^{n-2}                            \\
		+\, & (z-z_0)^{\rho } \sum_{i=0}^{\infty} p_i (z-z_0)^{i-1}\sum_{n=0}^{\infty}(n+\rho ) w_n (z-z_0)^{n-1} \\
		+\, & (z-z_0)^{\rho }\sum_{i=0}^{\infty} q_i (z-z_0)^{i-2} \sum_{n=0}^{\infty} w_n(z-z_0)^n =0.
	\end{aligned}
\]

观察到 \((z-z_0)^{\rho -2}\) 是可以约掉的，则：
\[
	\begin{aligned}
		    & \sum_{n=0}^{\infty}(n+\rho )(n+\rho -1) w_n(z-z_0)^{n}:                          & M_1 \\
		+\, & \sum_{i=0}^{\infty} p_i (z-z_0)^{i}\sum_{n=0}^{\infty}(n+\rho ) w_n (z-z_0)^{n}: & M_2 \\
		+\, & \sum_{i=0}^{\infty} q_i (z-z_0)^{i} \sum_{n=0}^{\infty} w_n(z-z_0)^n:            & M_3
	\end{aligned}
\]

由于东西比较多，不妨分而治之，首先考虑 \(M_2\)：
\[
	\sum_{i=0}^{\infty} p_i (z-z_0)^{i}\sum_{n=0}^{\infty}(n+\rho ) w_n (z-z_0)^{n}= \sum_{n=0}^{\infty}\sum_{i=0}^{\infty} w_n p_i (n+\rho ) (z-z_0)^{n+i}\xlongequal[]{\mbox{\tiny Cauthy乘积}}\sum_{n=0}^{\infty}\sum_{i=0}^{n} w_{i} p_{n-i} (i+\rho ) (z-z_0)^{n}
	.\]


然后是 \(M_3\) ：
\[
	\sum_{n=0}^{\infty}\sum_{i=0}^{\infty} q_i  w_n(z-z_0)^{n+i}\xlongequal[]{\mbox{\tiny Cauthy乘积}}\sum_{n=0}^{\infty}\sum_{i=0}^{n} q_{n-i} w_i (z-z_0)^n
	.\]

因此实际上就有（上面三者加起来）：
\[
	\label{CON}
	\sum_{n=0}^{\infty}\left( (n+\rho )(n+\rho -1)w_n+\sum_{i=0}^{n}( p_{n-i} (i+\rho ) + q_{n-i})w_{i} \right) z^n=0 \tag{CON}
	.\]

朱鹭子：看起来倒终于像个正经的级数了。

蓝：的确，为了求出 \(\rho \) ，我们把 \(n=0\) 这一项拿出来：
\[
	\rho (\rho -1)w_n +(\rho  p_0+q_0)w_0=0\implies \underline{\rho ^2+(p_0-1)\rho +q_0=0}
	.\]

此时我们完全可以令 \(w_0\neq 0\)，因为如果 \(w_0=0\)，此时可以通过调整 \(\rho \) 让新 \(w_0\neq 0\)。

上式就是指标要满足的方程，被称为\textbf{指标方程}。根据这个方程我们就可以求得 \(\rho _1\)和 \(\rho _2\)。接下来我们需要借助 \(\rho _1\) 和 \(\rho _2\) 的情况去讨论对数项的形式。

\begin{itemize}
	\item \(\rho _1=\rho _2\)，此时根据上面的讨论，对应的是矩阵 \(\symbfit{T} \)的特征值有重根的情形，而且此时的情况是，由于递推是线性的，我们两个 \(\rho _1\) 与 \(\rho _2\) 代进去得到的解必然是线性相关的，因此不含对数项是不行的。
	\item 如果 \(\rho _1-\rho _2\notin\symbb{Z} \) ，这实际上意味着我们把  \(\rho _1\) 与 \(\rho _2\) 代进去得到的解的\textbf{幂}完全不同，必然是线性无关的，此时该两个解就是微分方程的线性无关解，对数项也没有存在的必要了。
	\item \(\rho _1-\rho _2\in\symbb{Z}/\{0\} \)，此时是相当特殊的情况，如果\(\rho _1-\rho _2\notin\symbb{Z}/\{0\} \)，那么我们 \(w_n\) 的通项可以这么表示：
	      \[
		      w_n= -\dfrac{\sum_{i=0}^{n-1}( p_{n-i} (i+\rho ) + q_{n-i})w_{i}}{ (n+\rho )(n+\rho -1)+p_0(n+\rho )+q_0}\propto w_0
		      .\]

	      注意看！如果 \(\rho _1-\rho _2\) 是非零整数 \(m\)的话（由于前面规定说 \(\Re(\rho _1)\geqslant \Re(\rho _2)\)，因此 \(m\geqslant 1\)），这意味着，我们求完 \(\rho _1\) 对应的解（这里并不会有什么问题）之后求 \(\rho _2\) 对应的解是，会碰到：
	      \[
		      \begin{aligned}
			      w_m & = -\dfrac{\sum_{i=0}^{m-1}( p_{m-i} (i+\rho _2 ) + q_{m-i})w_{i}}{ (m+\rho _2 )(m+\rho _2 -1)+p_0(m+\rho _2 )+q_0} \\
			          & \implies (\rho _1(\rho _1 -1)+p_0\rho _1 +q_0)w_m+{\sum_{i=0}^{m-1}( p_{m-i} (i+\rho _2 ) + q_{m-i})w_{i}}=0.
		      \end{aligned}
	      \]

	      其中 \(w_m\) 的系数是指标方程，故为零，因此如果 \(\sum_{i=0}^{m-1}( p_{m-i} (i+\rho _2 ) + q_{m-i})w_{i}\neq 0\)，此时这样的形式必然没有解，换句话说，我们只能求出一种 \(\displaystyle (z-z_0)^{\rho _1}\sum_{n=0}^{\infty} a_n (z-z_0)^n\) 形式的解，因此对数项就有了存在的必要。如果 \(\sum_{i=0}^{m-1}( p_{m-i} (i+\rho _2 ) + q_{m-i})w_{i}=0\)，此时 \(w_m\) 的值无关紧要，完全可以认为是零（事实上不认为是零也一样的，只不过从 \(w_m\)往后的部分实际上将会是第一个解的一部分）。

\end{itemize}

朱鹭子：好！这就是全部的讨论？

蓝：差不多了，接下来我们来看些例子，由于例子比较长，我要用一个 subsection 来包裹它。

\subsection{Bessel方程}

蓝：Bessel方程的形状是：
\[
	\ddw+\frac{\dw}{z}+ \left( 1- \frac{\nu^2}{z^2 } \right) w=0,\, \Re(\nu )\geqslant 0
	.\]

这玩意来源于Helmholtz方程：
\[
	\nabla^2u+k^2 u=0
	.\]
在柱坐标系下的分离变量，此处不管。现在我们观察这个方程，首先 \(z=0\) 是方程的正则奇点，\(z=\infty\) 不讨论。在这里主要讨论方程在 \(z=0\) 的空心邻域 \(\left\vert z \right\vert >0\) 上的解。
设：
\[
	w(z)=z^\rho \sum_{n=0}^{\infty} w_n z^{n}
	.\]
代入方程 \hyperref[CON]{\underline{(CON)}}就可得到指标方程：
\[
	\rho ^2-\nu ^2=0 \implies \rho _1=\nu ,\,\rho _2=\nu \implies rho_1-\rho _2=2\nu
	.\]
和正儿八经的递推关系：
\[
	w_n((\rho +n)^2-\nu ^2)+w_{n-2}=0,\,n\geqslant 2
	.\]

因此承担分离出两个线性无关解的任务（看似）就落到了 \(w_0\) 和  \(w_1\) 头上。我们按部就班讨论。

\begin{itemize}
	\item \(2\nu \in\symbb{Z} \) 时，此时并没有对数什么关系，因此按部就班：
	      \[
		      w_n= -\frac{w_{n-2}}{(\rho +n)^2-\nu ^2}=-\frac{w_{n-2}}{n(n+2\rho )}
		      .\]
	      因此：
	      \[
		      \begin{aligned}
			      w_{2n}   & = -\frac{w_{2n-2}}{2n(2n+2\rho )}=\frac{w_{2n-4}}{2n(2n+2\rho )(2n-2)(2n-2+2\rho )}                                                                                                         \\
			               & =\dotsm\frac{(-1)^nw_0}{\prod_{i=1}^{n} (2i)(2i+2\rho )}=\frac{(-1)^nw_0}{4^n \Gamma (n+1)\prod_{i=1}^{n}(i+\rho )}=\frac{(-1)^n \Gamma (\rho +1)w_0}{4^n \Gamma (n+1) \Gamma (\rho +n+1)}. \\
			      w_{2n+1} & = -\frac{w_{2n-1}}{(2n+1)(2n+1+2\rho )} =\cdots \frac{(-1)^nw_1}{\prod_{i=1}^{n} (2i+1)(2i+1+2\rho )}                                                                                       \\
			               & = \frac{(-1)^nw_1}{4^n\prod_{i=1}^{n}\left( i+\frac{1}{2} \right) \left( i+\rho +\frac{1}{2} \right) }=
			      \frac{(-1)^n \Gamma (\frac{3}{2})\Gamma \left( \rho +\frac{3}{2} \right) w_1}{4^n \Gamma \left( n+\frac{3}{2} 	\right) \Gamma \left( n+\rho +\frac{3}{2} \right)  }.
		      \end{aligned}
	      \]
\end{itemize}

朱鹭子：等等！你这有问题吧，由于 \(w_{2n}\) 和 \(w_{2n-1}\) 是相互独立的，那就代表了两个线性无关解，但这样不就是…… 一个 \(\rho \) 对应两个线性无关解??????那最后不是就有四个解了吗？

蓝：所以我才说出两个线性无关解的任务（\textbf{看似}）就落到了 \(w_0\) 和  \(w_1\) 头上，但事实上有些东西会影响到我们对 \(w_0\) 和 \(w_1\) 的选取，而且并不是初始条件！比如这个所谓的正儿八经的递推关系实际上是不完全的，代进去事实上会得到：
\[
	\begin{aligned}
		           & \sum_{n=0}^{\infty} w_n\left( (n+\rho )^2-\nu ^2 \right) z^n +\sum_{n=0}^{\infty} w_n z^{n+2}=0          \\
		\implies\, & c_0(\rho ^2-\nu ^2)+c_1((\rho +1)^2-\nu ^2)z+\sum_{n=2}^{\infty} \left[ w_n((\rho +n)^2-\nu ^2)+w_{n-2} \right] z^n=0.
	\end{aligned}
\]

考虑到 \(z^1\) 的系数 \(c_1((\rho +1)^2-\nu ^2)=0\) ，我们立马就可以得到……

朱鹭子：\(c_1=0\)？哦不对，由于 \(\rho =\pm\nu \) 实际上是 \(\nu \neq \dfrac{1}{2}\) 的时候 \(c_1=0\) ，那么实际上此时所有的 \(w_{2n+1}\) 就都是零了。

蓝：对，此时实际上只有正经的一个解：
\[
	w= z^\rho  \sum_{n=0}^{\infty} \frac{(-1)^n \Gamma (\rho +1)w_0}{4^n \Gamma (n+1) \Gamma (\rho +n+1)}z^{2n}=z^\nu   \sum_{n=0}^{\infty} \frac{(-1)^n \Gamma (\rho +1)w_0}{\Gamma (n+1) \Gamma (\rho +n+1)} \left( \frac{z}{2} \right) ^n
	.\]

不妨设 \(w_0=\dfrac{1}{2^\nu  \Gamma (\nu +1)}\)，因此得到:
\[
	w= \sum_{n=0}^{\infty} \frac{(-1)^n}{\Gamma (n+1)\Gamma (n+\nu +1)} \left( \frac{z}{2} \right) ^{2n+\nu }\eqcolon \besselj_\nu(z)
	.\]

这被称为\textbf{第一类Bessel函数}。此时令 \(\rho =-\nu \) 的时候可以得到：
\[
	\besselj_{-\nu}(z)_ = \sum_{n=0}^{\infty} \frac{(-1)^n}{\Gamma (n+1)\Gamma (n-\nu +1)} \left( \frac{z}{2} \right) ^{2n-\nu }
	.\]

事实上你会发现虽然对应的是不同的 \(\rho \) 但两解的形式殊途同归，当然此时是在 \(2\nu \notin\symbb{Z} \) 的情况下推出来的。

朱鹭子：那如果是整数呢？

蓝：整数那就麻烦了。我们先来看看之前那个 \(\nu =\dfrac{1}{2}\) 的情况吧。此时我们知道 \(w_1\) 可以任意取值，我们取 \(0\) 的话，实际上会得到第二个解变成下面这种：
\[
w_{\rho =-\frac{1}{2}} = \underset{按照之前方法求出来的部分}{\underbrace{\sum_{n=0}^{\infty} \frac{(-1)^n}{\Gamma (n+1)\Gamma \left( n-\frac{1}{2} +1 \right) } \left( \frac{z}{2} \right) ^{2n-\frac{1}{2} }}} + \underset{z^{-1 /2}\sum_{n=0}^{\infty} 	 \frac{(-1)^n \Gamma\left(3 /2\right) w_1}{4^n \Gamma \left( n+3 /3	\right) \Gamma \left( n+1 \right)  } z^{2n+1}=w_1 \Gamma \left( \frac{3}{2} \right)  \cdot J_{1/2}(z)
}{\underbrace{z^{-\frac{1}{2}}\sum_{n=0}^{\infty} 	 \frac{(-1)^n \Gamma (\frac{3}{2})\Gamma \left( \rho +\frac{3}{2} \right) w_1}{4^n \Gamma \left( n+\frac{3}{2} 	\right) \Gamma \left( n+\rho +\frac{3}{2} \right)  } z^{2n+1}}} = \besselj_{-\frac{1}{2}}(z) +w_1\sqrt{ \frac{\symup\pi }{2}}\besselj_{\frac{1}{2}}(z)
.\]

发现得到的结果殊途同归，只是加上了第一个解乘上一个常数罢了。

接下来我们看看其他 \(\nu \in \symbb{Z} +\dfrac{1}{2}\) 的情况，此时这微分方程的解是有初等表达的。

朱鹭子：我超！！原来是有初等表达的。

蓝：是。我们知道此时我们先尝试代入 \(\mathrm J_ \nu (z)\) 和 \( \mathrm J_ {-\nu }(z)\)，看他们是否线性相关吧。

 \[
\begin{aligned}
	\mathrm J_ {k+\frac{1}{2}} (z) = \sum_{n=0}^{\infty} \frac{(-1)^n}{\Gamma (n+1)\Gamma (n+k +3 /2)} \left( \frac{z}{2} \right) ^{2n+k +\frac{1}{2} } \\ 
	\mathrm J_ {-k-\frac{1}{2}} (z) = \sum_{n=0}^{\infty} \frac{(-1)^n}{\Gamma (n+1)\Gamma (n-k -3 /2)} \left( \frac{z}{2} \right) ^{2n-k -\frac{1}{2} } 
\end{aligned}
 .\]

 朱鹭子：最低次幂都不一样，怎么可能线性相关？

 蓝：（笑）也是，接下来我们看下关于初等解的事情，首先来看下 \( J_{\frac{1}{2}}(z)\)：
 \[
\begin{aligned}
	J_{\frac{1}{2}}(z) &= \sum_{n=0}^{\infty} \frac{(-1)^n}{\Gamma (n+1)\Gamma \left( n+\frac{1}{2} +1 \right) } \left( \frac{z}{2} \right) ^{2n+\frac{1}{2}}=
	\sum_{n=0}^{\infty} \frac{(-1)^n }{n!\prod_{i=1}^{n} (i+ 1/ 2) } \left( \frac{z}{2} \right) ^{2n+\frac{1}{2}} \\ 
&=\frac{1}{\Gamma (3 /2)}\sum_{n=0}^{\infty} \frac{(-1)^n 4^n}{(2n+1)!}\left( \frac{z}{2} \right) ^{2n+\frac{1}{2}} = \frac{1}{\Gamma (3 /2)\sqrt{z}}\sum_{n=0}^{\infty} \frac{(-1)^n z ^{2n+1}}{(2n+1)!} = \sqrt{\frac{2}{\symup \pi z}}\sin z
.\end{aligned}
 \]

 朱鹭子：哇！原来是因为刚好是有 \(\Gamma (n+1)\) 和 \(\Gamma (n+1 /2)\) 才能这样啊。

 蓝：的确，用同样的方法可以求得 \(\besselj _{-\frac{1}{2}}(z)=\sqrt{\dfrac{2}{\symup \pi z}}\cos  z\)。

 接下来我们考虑另外一件事……先不要把上面 \(\nu =\dfrac{3}{2}\) 代进去。我们先看看这个函数：
 \[
 K_{\nu }(z) =  \frac{\besselj _{\nu }(z)}{z^\nu }
 .\]

 由第一类Bessel函数的形状可以知道这个函数是解析的：
 \[
	 \begin{aligned}
		K_{\nu }(z)& = \sum_{n=0}^{\infty} \frac{(-1)^nz^{2n}}{\Gamma (n+1)\Gamma (n+\nu +1)2^{2n+\nu }} \\
		\implies\symscr{D} _z( K_{\nu }(z)  )&=
		\sum_{n=1}^{\infty} \frac{2n(-1)^nz^{2n-1}}{\Gamma (n+1)\Gamma (n+\nu +1)2^{2n+\nu }} \\ 
	 &=	\sum_{n=0}^{\infty} \frac{2(-1)^{n+1} z^{2n+1}}{\Gamma (n+1)\Gamma (n+\nu +2)2^{2n+\nu +2}} \\
	 &=-\sum_{n=0}^{\infty} \frac{(-1)^{n} z^{2n+1}}{\Gamma (n+1)\Gamma (n+\nu +2)2^{2n+\nu +2}}\\
	 &=-z\sum_{n=0}^{\infty} \frac{(-1)^{n} z^{2n}}{\Gamma (n+1)\Gamma (n+\nu +2)2^{2n+\nu +2}}=-zK_{\nu +1}(z).
	 \end{aligned}
\]
这实际上意味着：
\[
\besselj _{\nu +1}(z) = - z^\nu \symscr{D} _z\left(  \frac{\besselj _{\nu}(z) }{z^\nu } \right) =\symscr{D} _z(\besselj _ \nu (z))- \frac{\nu}{z}\besselj _ \nu (z)
.\]

朱鹭子：！！这样子就有递推公式了！

蓝：确实，但这公式对级数解效果并不是很好，但是由于我们知道的确有一个所谓的初等解，这样就可以意味着推出所有的正半整数阶的第一类 Bessel 都是初等的。

仿照 \(K_ \nu (z)\) 函数的方法，同样可以证明 \(\besselj _{\nu -1}(z)= \dfrac{\symscr{D} _z(x^\nu \besselj _ \nu (z))}{x^\nu }\) ，这样可以推出所有的负半整数阶的也是初等的。

朱鹭子：原来可以这样……那还剩最后一种情况吧？那就是 \(\nu \) 是整数的时候？

蓝：是，事实上由于我们之前规定过 \(\Re(\nu )\geqslant 0\) ，所以实际上是非负整数。此时对于 \(\besselj _ \nu (z)\) 并不会有什么影响，但事实上由于讨论这个 \(\besselj _{-\nu }(z)\) 的时候（且 \(\nu \geqslant 1\)），当 \(n=0,1,\cdots \nu -1\) 的时候，有 \( \Gamma (n-\nu+1 )=\infty\) ，此时 \(\besselj _{-\nu }(z)\) 的前 \(\nu\) 项系数会变为零，即：
 \[
\besselj _ {-\nu }(z) = \sum_{n=0 }^{\infty} \frac{(-1)^n}{\Gamma (n+1)\Gamma (n-\nu +1)}\left( \frac{z}{2} \right) ^{2n-\nu } =  
\sum_{n=0}^{\infty} \frac{(-1)^{n+\nu }}{\Gamma (n+1+\nu )\Gamma (n+1)}\left( \frac{z}{2} \right) ^{2n+2\nu -\nu }=(-1)^\nu\besselj _ \nu (z)
 .\]

 实际上与第一解是线性相关的，当 \(\nu =0\) 的时候因为正负一样，自然没有什么第二解。因此此时带有对数项的解是有必要的。

 朱鹭子：原来对数项是按需存在的啊……

蓝：你要这么认为也行吧（笑）。总之我们当然可以直接把对数项硬代进去解，因为我们第一解 \(\besselj _{\nu }(z)\) 是解出来的，但计算量确实比较大。

朱鹭子：看得出来\emoji{😰}。

蓝：事实上，我们有其他办法可以糊弄过去。

朱鹭子：诶？这还能糊弄？

蓝：为了考虑两个解是否相关，我们又可以尝试下Wronsky行列式，由于之前的讨论我们有：
\[
	\symscr{W}[\,\besselj_{\nu}(z),\besselj_{- \nu} (z)] = C\exp \left( -\int p(z) \,\mathrm{d}z  \right) =C\exp \left( -\int \frac{1}{z} \,\mathrm{d}z  \right) =\frac{C}{z}
.\]
此时我们不管什么 \(\symscr{W} (z_0)\) 什么的，直接讨论Wronsky行列式的最基本形式（当然此时的 \(z_0\)要求比较特殊）。很显然， \(C\) 必然和 \(\nu \) 有关，因此我们的首要工作就是求出这个 \(C\)。

朱鹭子：我不理解……为什么要这样子做？

蓝：其实关键是这样的，我们知道：
\[
	(-1)^{\nu }\besselj _ \nu (z)-\besselj _ {-\nu }(z)= \omicron (1),\,\nu  \to\symbb{Z} 
.\]

但实际上
\[
	\frac{(-1)^{\nu }\besselj_ \nu (z)-\besselj _ {-\nu }(z)}{\nu -\symbb{Z} }
.\]

不一定为零吧，因为这样子就要上下求导，从而破坏了分子的结构——而且是对 \(\nu \) 求导（L'Hospital法则），这样得到的函数依然是方程的解，但我们只是仅仅大概知道方向，具体的构造和线性无关性的证明还是得依赖Wronsky行列式。

——现在我们的目的是要求出 \(C\) 。

朱鹭子：好吧……那就先求……但是这个 Bessel 函数的 Wronsky 行列式应该怎么求捏？

蓝：事实上我们知道这个行列式必然是 \( \dfrac Cz\) 的形状，因此可以直接写成：
\[
	\dfrac Cz= \besselj_ \nu (z)\symscr{D} _ z(\besselj_{-\nu }(z))-\besselj_{- \nu} (z)\symscr{D} _ z(\besselj_{\nu }(z))
.\]

由于 \( \besselj_ \nu (z)\) 中 \(z\) 的幂必然大于等于 \(-\nu \)，因此 \( \besselj_ \nu (z)\symscr{D} _ z(\besselj_{-\nu }(z))\) 和 \(\besselj_{- \nu} (z)\symscr{D} _ z(\besselj_{\nu }(z))\) 这些函数的 \(z\) 的幂最小必然是 \(-1\) ，此时，仅仅只需讨论这些函数的\textbf{第一项}：\( \dfrac{1}{2^\nu \Gamma (1+\nu )}\)和 \(\dfrac{2^\nu}{ \Gamma (1-\nu )}\)。

（记得求导）代进去可以得到：
\[
C= -\frac{2\nu }{\Gamma (1+\nu )\Gamma (1-\nu )} = -\frac{2}{\Gamma (\nu )\Gamma (1-\nu )}= -\frac{2}{\symup \pi }\sin \pi \nu \tag{Bessel.C}
.\]

最后一个等号用到了 \(\Gamma \)函数的余元公式：
\[
\Gamma (z)\Gamma (1-z)=\symup \pi \csc \pi z
.\]

从(Bessel.C)方程我们可以清楚知道，当 \(\nu \) 为整数时，两解对应的Wronsky行列式为零，因此线性相关，但是考虑另外一种函数（事实上是两个解的线性组合）：
\[
w_{\rm new} = A \cdot \besselj_ \nu (z) - \csc \symup \pi \nu  \besselj_{-\nu }(z)
.\]

乍一看好像这个函数和什么 \( \besselj_ \nu (z)\) 和 \( \besselj_ {-\nu} (z)\) 线性相关的，但实际上也不算是，注意看Wronsky行列式：
\[
	\symscr{W}[\,\besselj_{\nu}(z),A \cdot \besselj_ \nu (z) - \csc \symup \pi \nu  \besselj_{-\nu }(z)]=-\csc  \symup \pi  \nu\cdot  \symscr{W}[\,\besselj_{\nu}(z),\besselj_{- \nu} (z)]= \frac{2}{\symup \pi }\neq 0
.\]
看！是线性无关的吧！

朱鹭子：等等！！你这是作弊！！此时 \(\nu \) 是整数的话，你那个 \(\besselj_{-\nu }(z)\) 的系数应该是发散到无穷的！

蓝：所以嘛，这也是一种相当赌博的方法，现在我得想办法把这个点的奇异性消除，即变为可去奇点。由前面的讨论是可以知道此时
\[
	(-1)^{\nu }\besselj _ \nu (z)-\besselj _ {-\nu }(z)=0
.\]

这是否意味着这玩意有个至少一阶的零点？

朱鹭子：……也是……因为当 \(\nu \) 是整数的时候两个解是解析的——但是你这样说有问题吧？明明要考虑了 \(\nu \) 在某整数的邻域上面才能说几阶零点，那你这不是意味着这玩意默认解析吗？\(\nu \) 不是整数的时候哪有这等好事？

蓝：没错，事实上你从知道第二解有对数就应该清楚没有那么单纯——这意味着它不能满足在 \(z_0\) 处的有界初始条件。 总之我们先继续讨论，为了避免离散化的 \((-1)^{\nu}\)，我把它换成 \(\cos \symup \pi \nu \) ，因此第二解的形式我可以\textbf{猜测成}：
\[
w_{\rm guess}= \frac{\besselj_ \nu (z)\cos \symup \pi \nu - \besselj_{ -\nu} (z)}{\sin \symup \pi  \nu }
.\]

只要 \(\nu \) 不是整数，此时 \(\besselj_ \nu (z)\) 和 \(\besselj_{-\nu }(z)\) 线性无关，而这个猜的解是它们的正常的线性组合，因此与 \(\besselj_ \nu (z)\) 正交。但如果  \(\nu \) 是整数，我们需要使用 L'Hospital 法则来求极限（对 \(\nu \) 求导）：
\[
\begin{aligned}
	w_{\rm guess} &\to \frac{1}{\symup \pi }\symscr{D} _ \nu (\besselj_ \nu (z)\cos \symup \pi \nu - \besselj_{ -\nu} (z) ) \\ 
&=\frac{(-1)^\nu }{\symup \pi }(\symscr{D} _ \nu( \besselj_ \nu (z))\cos \symup \pi \nu -\besselj_ \nu (z)\sin \symup \pi \nu - \symscr{D} _ \nu( \besselj_{ -\nu} (z) )) \\
&=\frac{1}{\symup \pi }(\symscr{D} _ \nu( \besselj_ \nu (z)) - (-1)^\nu \symscr{D} _ \nu( \besselj_{ -\nu} (z) ))\\
&=\frac{1}{\symup \pi } \left[ \symscr{D} _ \nu\left(  \sum_{n=0}^{\infty} \frac{(-1)^n}{\Gamma (n+1)\Gamma (n+\nu +1)} \left( \frac{z}{2} \right) ^{2n+\nu }\right) -(-1)^\nu\symscr{D} _ \nu\left(  \sum_{n=0 }^{\infty} \frac{(-1)^n}{\Gamma (n+1)\Gamma (n-\nu +1)} \left( \frac{z}{2} \right) ^{2n-\nu }\right)  \right] 
\end{aligned}
\]

朱鹭子：那有个问题，这个 \(\Gamma \)  函数的求导——

蓝：事实上主要难点可以变成：
\[
\symscr{D} _{\nu }\left( \frac{z^ \nu }{\Gamma (\nu )} \right) = z^\nu \frac{\Gamma (\nu )\ln z-\symscr{D} _{\nu }(\Gamma (\nu ))}{\Gamma (\nu )^2}=z^\nu  \frac{\ln z-\symup \psi (\nu )}{\Gamma (\nu )}
.\]

那么实际上就是（举第一个例子）：
\[
\begin{aligned}
	\symscr{D} _ \nu\left(  \sum_{n=0}^{\infty} \frac{(-1)^n}{\Gamma (n+1)\Gamma (n+\nu +1)} \left( \frac{z}{2} \right) ^{2n+\nu }\right) &= \sum_{n=0}^{\infty} (-1)^n  \frac{\ln \frac{z}{2}-\symup \psi (\nu+n+1 )}{\Gamma (n+1)\Gamma (n+\nu +1)} \left( \frac{z}{2} \right) ^{2n+\nu } \\ 
	&= \besselj_ {\nu } (z)\ln \frac{z}{2}-\sum_{n=0}^{\infty}  \frac{ (-1)^n\symup \psi (\nu+n+1 )}{\Gamma (n+1)\Gamma (n+\nu +1)} \left( \frac{z}{2} \right) ^{2n+\nu }.\\
	\symscr{D} _ \nu\left(  \sum_{n=0 }^{\infty} \frac{(-1)^n}{\Gamma (n+1)\Gamma (n-\nu +1)} \left( \frac{z}{2} \right) ^{2n-\nu }\right) &= \sum_{n=0 }^{\infty} (-1)^n  \frac{\ln \frac{z}{2}-\symup \psi (n-\nu+1 )}{\Gamma (n+1)\Gamma (n-\nu +1)} \left( \frac{z}{2} \right) ^{2n-\nu } \\ 
	&= -\besselj_ {-\nu } (z)\ln \frac{z}{2}+\sum_{n=0}^{\infty}  \frac{ (-1)^n\symup \psi (n-\nu+1 )}{\Gamma (n+1)\Gamma (n-\nu +1)} \left( \frac{z}{2} \right) ^{2n-\nu }.
\end{aligned}
\]

朱鹭子：真是恐怖的计算……

蓝：计算的事情可以不管嘛……总之加起来就是：
\[w_{\rm guess}\to 
\dfrac{\besselj_ {\nu } (z)\ln \frac{z}{2}-\sum_{n=0}^{\infty}  \frac{ (-1)^n\symup \psi (\nu+n+1 )}{\Gamma (n+1)\Gamma (n+\nu +1)} \left( \frac{z}{2} \right) ^{2n+\nu }-(-1)^\nu \left( -\besselj_ {-\nu } (z)\ln \frac{z}{2}+\sum_{n=0 }^{\infty}  \frac{ (-1)^n\symup \psi (n-\nu+1 )}{\Gamma (n+1)\Gamma (n-\nu +1)} \left( \frac{z}{2} \right) ^{2n-\nu } \right) }{\symup \pi }
.\]

考虑到 \(\besselj_ {\nu } (z) = (-1)^\nu \besselj_ {-\nu } (z)  \)，我们可以小小化简一下：
\[\begin{aligned}
	w_{\rm guess}&\to \frac{2}{\symup \pi }\besselj_{\nu } (z)\ln \frac{z}{2} -\frac{1}{\symup \pi }\sum_{n=0}^{\infty}  \frac{ (-1)^n\symup \psi (\nu+n+1 )}{\Gamma (n+1)\Gamma (n+\nu +1)} \left( \frac{z}{2} \right) ^{2n+\nu }-\frac{(-1)^\nu}{ \symup \pi }\sum_{n=0 }^{\infty}  \frac{ (-1)^n\symup \psi (n-\nu+1 )}{\Gamma (n+1)\Gamma (n-\nu +1)} \left( \frac{z}{2} \right) ^{2n-\nu }\\ 
&=\frac{2}{\symup \pi }\besselj_{\nu } (z)\ln \frac{z}{2}-\frac{1}{\symup \pi }\sum_{n= 0 }^{\infty}  
\left( \frac{ (-1)^n\symup \psi (\nu+n+1 )}{\Gamma (n+1)\Gamma (n+\nu +1)} \left( \frac{z}{2} \right) ^{2n+\nu }+\frac{ (-1)^n\symup \psi (n+1 )}{\Gamma (n+1)\Gamma (n+\nu +1)} \left( \frac{z}{2} \right) ^{2n+\nu } \right) \\
&-\frac{1}{\symup \pi }(-1)^\nu   \sum_{n=0}^{\nu -1} \frac{(-1)^n\symup \psi (n-\nu +1)}{\Gamma (n+1)\Gamma (n-\nu +1)}\left( \frac{z}{2} \right) ^{2n-\nu } \\
&=  \dfrac{2\besselj_{\nu } (z)\ln \frac{z}{2}-\sum_{n= 0 }^{\infty} (-1)^n \frac{ \symup \psi (\nu+n+1 )+\symup \psi (n+1 )}{\Gamma (n+1)\Gamma (n+\nu +1)} \left( \frac{z}{2} \right) ^{2n+\nu }
- \sum_{n=0}^{\nu -1} \frac{(-1)^{n+\nu }\symup \psi (n-\nu +1)}{\Gamma (n+1)\Gamma (n-\nu +1)}\left( \frac{z}{2} \right) ^{2n-\nu }}{\symup \pi }.
\end{aligned}
\]

朱鹭子：等等，你最后一项是什么意思？

蓝：看，我们之前省略这个 \(\besselj_{-\nu }(z)\) 的前 \(\nu \) 项是因为分母的 \(\Gamma \)函数会趋向于无穷，但实际上在这里的 \(\symup \psi \) 函数也会发散到无穷——虽然两者的比值是有界的。因此我们不能随意省略，这里为了便于计算将其提出来（当然 \(\nu =0\) 时没有必要，此时忽略此求和）。目前我们可以这样考虑：

首先 \(\Gamma \) 函数的所有极点都是一阶极点，并且：
\[
	\res\left\{  \Gamma(-n) \right\}=\dfrac{(-1)^n}{n!}
.\]
而 \(\symup \psi \)函数的所有极点也都是一阶极点
\[
	\res\left\{  \symup \psi(-n) \right\}= -1
.\]

因此实际上我们可以认为：
\[
 \frac{  \symup \psi(-n)}{\Gamma(-n)} = (-1)^{n-1}\Gamma (n+1)
.\]

因此最后一项其实是：
\[
	-\frac{1}{\symup \pi }(-1)^\nu  \sum_{n=0}^{\nu -1} \frac{(-1)^n(\nu -1-n)!}{\Gamma (n+1)}\left( \frac{z}{2} \right) ^{2n-\nu }(-1)^{n-\nu }=-\frac{1}{\symup \pi }\sum_{n=0}^{\nu -1} \frac{\Gamma (\nu -n )}{\Gamma (n+1)}\left( \frac{z}{2} \right) ^{2n-\nu }
.\]

另外，我们也可以对前面的 \(\symup \psi\) 函数做一些处理：
\[
\symup \psi (n) = \sum_{i=1}^{n-1} \frac{1}{i}-\symup\gamma,\,n\in\symbb{Z} ,n\geqslant 2
.\]

不妨定义：
\[
H(0)=0,\,H(n)= \sum_{i=1}^{1}  \frac{1}{i},\,n\in\symbb{Z} ,n\geqslant 1
.\]

则最终的 \(w_{\rm guess}\) 可以化成：
\[
	w_{\rm guess}=\frac{2}{\symup \pi }\besselj_{\nu } (z)\ln \frac{z}{2}-\frac{1}{\symup \pi }\sum_{n= 0 }^{\infty} (-1)^n \frac{H(\nu +n)+H(n)-2\symup\gamma}{\Gamma (n+1)\Gamma (n+\nu +1)} \left( \frac{z}{2} \right) ^{2n+\nu }-
	\underset{ \nu =0 的时候忽略这一项}{\underline{\frac{1}{\symup \pi }\sum_{n=0}^{\nu -1} \frac{\Gamma (\nu -n )}{\Gamma (n+1)}\left( \frac{z}{2} \right) ^{2n-\nu }}}
.\]

此时容易观察到，这是符合我们之前认为的解的形状（\(gw_1(z)\ln z+\)一坨奇怪的幂级数），事实上它就是原方程的一个解，这个解被称为\textbf{第二类Bessel函数}：
\[
\bessely_ \nu (z)\coloneq \begin{cases}
	\dfrac{\besselj_ \nu (z)\cos \symup \pi \nu - \besselj_{ -\nu} (z)}{\sin \symup \pi  \nu }&\nu \in\symbb{Z} ,	 \\[20pt]
	\begin{aligned}
		&\displaystyle \frac{2}{\symup \pi }\besselj_{\nu } (z)\ln \frac{z}{2}-
		\underset{ \nu =0 的时候忽略这一项}{\underline{\frac{1}{\symup \pi }\sum_{n=0}^{\nu -1} \frac{\Gamma (\nu -n )}{\Gamma (n+1)}\left( \frac{z}{2} \right) ^{2n-\nu }}} \\ 
		&-\frac{1}{\symup \pi }\sum_{n= 0 }^{\infty} (-1)^n \frac{H(\nu +n)+H(n)-2\symup\gamma}{\Gamma (n+1)\Gamma (n+\nu +1)} \left( \frac{z}{2} \right) ^{2n+\nu },
	\end{aligned}& \nu \in\symbb{Z} .
\end{cases}
\]
\end{document} 
